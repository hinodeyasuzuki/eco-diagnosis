var D6=D6||{};if(onmessage=function(t){var e=t.data.param;t.data.param||(e=""),void 0!==e.targetMode&&(D6.targetMode=e.targetMode);var s=D6.workercalc(t.data.command,e);try{postMessage({command:t.data.command,result:s},"http://"+window.location.hostname)}catch(e){postMessage({command:t.data.command,result:s})}},D6.workercalc=function(e,t){var s={};switch(e){case"start":if(D6.viewparam=D6.viewparam||{},D6.viewparam.ode=t.ode,D6.viewparam.focusMode=t.focusMode,D6.viewparam.countfix_pre_after=t.countfix_pre_after,t.debugMode&&1==t.debugMode?D6.debugMode=!0:D6.debugMode=!1,D6.constructor(t.prohibitQuestions,t.allowedQuestions,t.defInput),void 0!==t.rdata&&t.rdata)try{D6.doc.loadDataSet(decodeURIComponent(escape(atob(t.rdata))))}catch(e){}D6.calculateAll(),(s=D6.getAllResult("consTotal")).inputPage=D6.getInputPage(t.consName,t.subName),s.quesone=D6.getFirstQues(t.consName,t.subName),D6.debugMode&&(console.log("d6 construct value ----"),console.log(D6));break;case"addandstart":var i=D6.doc.serialize();t.rdata=btoa(unescape(encodeURIComponent(i))),D6.addConsSetting(t.consName),D6.setscenario("add"),void 0!==t.rdata&&D6.doc.loadDataSet(decodeURIComponent(escape(atob(t.rdata))),"add"),D6.calculateAll();var a=D6.consListByName[t.consName][0].sumConsName;(s=D6.getAllResult(a)).inputPage=D6.getInputPage(a,t.subName);break;case"tabclick":(s=D6.getAllResult(t.consName)).inputPage=D6.getInputPage(t.consName,t.subName),s.quesone=D6.getFirstQues(t.consName,t.subName);break;case"subtabclick":s.inputPage=D6.getInputPage(t.consName,t.subName),s.subName=t.subName;break;case"inchange":D6.inSet(t.id,t.val),t.id==D6.scenario.measuresSortChange&&(D6.sortTarget=D6.scenario.measuresSortTarget[t.val<0?0:t.val]),D6.calculateAll(),s=D6.getAllResult();break;case"inchange_only":D6.inSet(t.id,t.val),s="ok";break;case"quesone_next":s.quesone=D6.getNextQues();break;case"quesone_prev":s.quesone=D6.getPrevQues();break;case"quesone_set":D6.inSet(t.id,t.val),s.quesone=D6.getNextQues();break;case"recalc":D6.calculateAll(),(s=D6.getAllResult(t.consName)).inputPage=D6.getInputPage(t.consName,t.subName);break;case"pagelist":s.inputPage=D6.getInputPage(t.consName,t.subName);break;case"measureadd":case"measureadd_comment":D6.measureAdd(t.mid),D6.calcMeasures(-1),s=D6.getAllResult();break;case"measuredelete":D6.measureDelete(t.mid),D6.calcMeasures(-1),s=D6.getAllResult();break;case"graphchange":s.itemize_graph=D6.getItemizeGraph("",t.graph);break;case"evaluateaxis":s.evaluateAxis=D6.getEvaluateAxisPoint("",t.subName);break;case"add_demand":i=D6.doc.serialize();t.rdata=btoa(unescape(encodeURIComponent(i))),D6.addConsSetting(t.consName),D6.setscenario("add"),t.rdata&&D6.doc.loadDataSet(decodeURIComponent(escape(atob(t.rdata))),"add");case"demand":s.demandin=D6.getInputDemandSumup(),s.demandlog=D6.getInputDemandLog(),s.graphDemand=D6.getDemandGraph();break;case"inchange_demand":D6.inSet(t.id,t.val),s.graphDemand=D6.getDemandGraph();break;case"modal":var o=t.mid;s.measure_detail=D6.getMeasureDetail(o);break;case"save":case"savenew":case"saveandgo":case"save_noalert":i=D6.doc.serialize();s=btoa(unescape(encodeURIComponent(i)));break;case"load":break;case"getinputpage":s.inputPage=D6.getInputPage(t.consName,t.subName);break;case"getqueslist":s.queslist=D6.getQuesList();break;case"common":var n=!1;if(void 0!==t.construct&&t.construct&&D6.constructor(t.prohibitQuestions,t.allowedQuestions,t.defInput),void 0!==t.rdata&&t.rdata)try{D6.doc.loadDataSet(decodeURIComponent(escape(atob(t.rdata))))}catch(e){}if(void 0!==t.id&&t.id&&D6.inSet(t.id,t.val),void 0!==t.inputs&&t.inputs)for(var c in t.inputs)D6.inSet(t.inputs[c].id,t.inputs[c].val);void 0!==t.addmeasureid&&t.addmeasureid&&(D6.measureAdd(t.addmeasureid),n=!0),void 0!==t.deletemeasureid&&t.deletemeasureid&&(D6.measureDelete(t.deletemeasureid),n=!0),n?(D6.calcMeasures(-1),s=D6.getAllResult()):(void 0!==t.calc||t.calc)&&D6.calculateAll(-1),(void 0!==t.getresult||t.getresult)&&(s=D6.getAllResult()),(void 0!==t.getinput||t.getinput)&&(s.inputPage=D6.getInputPage(t.consName,t.subName))}return s},D6.acadd={factorPrefTimeMonth:[[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],[[.17,.16,.14,.12,.09,.06,.05],[.06,.05,.04,.04,.03,.02,.01],[.09,.09,.07,.06,.04,.03,.02],[.16,.15,.13,.11,.09,.06,.04]]],getArray:function(e){var t=e;return(47<t||t<0)&&(t=0),this.factorPrefTimeMonth[parseInt(t)]}},D6.accons={factorPrefTimeMonth:[[[.69,.65,.6,.56,.5,.42,.38,.34,.33,.28,.23,.18],[.45,.42,.39,.36,.32,.28,.27,.65,.63,.55,.48,.39],[.53,.5,.46,.43,.38,.32,.31,.46,.44,.4,.34,.28],[.68,.63,.59,.55,.5,.41,.37,.29,.28,.24,.2,.16]],[[1.24,1.22,1.21,1.18,1.13,.94,.77,.06,.05,.03,.02,.02],[1.14,1.13,1.1,1.05,.98,.8,.67,.2,.17,.13,.1,.08],[1.2,1.19,1.16,1.13,1.06,.88,.72,.1,.08,.05,.04,.03],[1.24,1.22,1.21,1.18,1.13,.95,.79,.03,.02,.01,.01,.01]]],getArray:function(e){var t=e;return(47<t||t<0)&&(t=0),this.factorPrefTimeMonth[t]}},D6.acload={factorPrefTimeMonth:[[[.66,.63,.6,.57,.52,.52,.44,.48,.48,.39,.33,.26],[.5,.47,.44,.41,.36,.31,.31,.78,.76,.69,.61,.51],[.56,.53,.5,.47,.42,.36,.34,.62,.6,.54,.47,.38],[.65,.62,.59,.56,.52,.43,.39,.41,.4,.34,.29,.22]],[[1.06,1.05,1.03,1,.95,.95,.82,.09,.09,.05,.03,.02],[.93,.92,.9,.87,.83,.7,.59,.27,.23,.18,.14,.11],[.99,.98,.96,.93,.88,.76,.64,.14,.11,.07,.05,.04],[1.05,1.04,1.02,.99,.95,.83,.7,.04,.03,.02,.01,.01]]],getArray:function(e){var t=e;return(47<t||t<0)&&(t=0),this.factorPrefTimeMonth[t]}},D6.area={prefName:["hyogo","hokkaido"],prefDefault:0,prefHeatingLevel:[4,1,2,2,3,2,2,3,3,3,3,4,4,4,4,3,3,3,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,4,4,4,4,4,5,5,6],co2ElectCompanyUnit:[.55,.55,.55,.55,.55,.55,.55,.55,.55,.55,.55],prefToEleArea:[5,0,1,1,1,1,1,1,2,2,2,2,2,2,2,1,4,4,4,2,3,3,3,3,3,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,9],electCompanyPrice:[1.2,1,1,1,1,1,1,1,1,1.2],elecPrice:{1:[33.32,33.32,33.32,-1500,0],2:[33.32,33.32,33.32,-1500,280],3:[38.89,27.32,13.1,2160,0],4:[17.98,16.53,16.53,0,1054],5:[20.22,18.56,18.56,64800,0],6:[22.58,17.36,13.08,0,1733]},prefTemplature:[17.4,9.4],prefPVElectricity:[4.04,3.95],energyCode2id:{electricity:0,gas:1,kerosene:2,car:3},seasonCode2id:{winter:0,spring:1,summer:2},seasonMonth:{winter:4,spring:5,summer:3},airconFactor_mon:[[.66,.62,.59,.55,.5,.41,.37,.39,.36,.31,.26,.2],[.43,.39,.37,.34,.3,.27,.26,.79,.75,.67,.59,.49],[.47,.45,.42,.39,.35,.3,.29,.57,.55,.49,.43,.35],[.62,.58,.55,.51,.47,.39,.35,.34,.32,.27,.23,.18]],heatFactor_mon:[[.64,.61,.6,.57,.53,.53,.44,.54,.54,.43,.36,.28],[.48,.45,.42,.39,.34,.3,.3,.88,.85,.78,.7,.59],[.52,.49,.47,.43,.39,.33,.32,.72,.7,.64,.56,.46],[.62,.59,.57,.54,.5,.42,.38,.48,.45,.39,.32,.25]],plusHeatFactor_mon:[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],getElectCompany:function(e){return this.prefToEleArea[e]},getTemplature:function(e){return this.prefTemplature[e]},getPVElectricity:function(e){return this.prefPVElectricity[e]},getHeatingLevel:function(e){return this.prefHeatingLevel[e]},getCo2Unit:function(e){return this.co2ElectCompanyUnit[e]},getAverageCostEnergy:function(e,t,s){var a,o;for(i in a=new Array,this.energyCode2id)o=this.energyCode2id[i],a[i]=this.prefKakeiEnergy[t][o]*this.kakeiNumCoefficent[(6<e?6:e)-1][o]*this.urbanCostCoefficient[o][s]/this.urbanCostCoefficient[o][0];return a},getWaterTemplature:function(){return Math.max(5,Math.min(23,.9137*this.averageTemplature+1.303))},getHeatFactor:function(e,t){var s,i=[0,0,0],a=[0,0,0],o=0;return s=e<=.7?0:e<=1.5?1:e<=2.5?2:e<=3.5?3:e<=5?4:e<=7?5:6,0<=t&&(i[0]+=this.airconFactor_mon[2][s],i[1]+=this.heatFactor_mon[2][s],i[2]+=this.plusHeatFactor_mon[2][s],o++),6<t&&(i[0]+=this.airconFactor_mon[0][s],i[1]+=this.heatFactor_mon[0][s],i[2]+=this.plusHeatFactor_mon[0][s],o++),10<t&&(i[0]+=this.airconFactor_mon[1][s],i[1]+=this.heatFactor_mon[1][s],i[2]+=this.plusHeatFactor_mon[1][s],o++),16<t&&(i[0]+=this.airconFactor_mon[3][s],i[1]+=this.heatFactor_mon[3][s],i[2]+=this.plusHeatFactor_mon[3][s],o++),a[0]=i[0]/o,a[1]=i[1]/o,a[2]=i[2]/o,a},getCoolFactor:function(e,t){var s,i=[0,0,0],a=[0,0,0],o=0;return s=e<=.7?7:e<=1.5?8:e<=2.5?9:e<=3.5?10:11,0<=t&&(i[0]+=this.airconFactor_mon[2][s],i[1]+=this.heatFactor_mon[2][s],o++),6<t&&(i[0]+=this.airconFactor_mon[1][s],i[1]+=this.heatFactor_mon[1][s],o++),12<t&&(i[0]+=this.airconFactor_mon[3][s],i[1]+=this.heatFactor_mon[3][s],o++),18<t&&(i[0]+=this.airconFactor_mon[0][s],i[1]+=this.heatFactor_mon[0][s],o++),a[0]=i[0]/o,a[1]=i[1]/o,a[2]=i[2]/o,a},prefKakeiEnergy:[[7959,5661,313,2647],[7568,5400,3772,3984]],prefSeasonFactorArray:[[[1.1084,1.3537,2.5436,.9465],[.8664,.9165,.3546,.9764],[1.0782,.6675,.0175,1.1107]],[[1.149,1.1094,1.8254,.9243],[.9482,.9876,.8169,1.0159],[.8876,.8749,.2047,1.0743]]],getSeasonFactor:function(e){return this.prefSeasonFactorArray[e]},getSeasonParam:function(e){var t=this.getSeasonFactor(e);return ret=Array(),ret.electricity=[t[0][0],t[1][0],t[2][0]],ret.gas=[t[0][1],t[1][1],t[2][1]],ret.kerosene=[t[0][2],t[1][2],t[2][2]],ret},kakeiNumCoefficent:[[.47,.52,.37,.45],[.86,.83,.9,.79],[.99,1,.9,.98],[1.07,1.1,.85,1.16],[1.24,1.17,1.1,1.26],[1.55,1.19,1.67,1.33]],urbanCostCoefficient:[[8762,9618],[6100,5133],[828,1898],[3415,6228]],setPersonArea:function(e,t,s){switch(this.urban=1==s||2==s?1:0,t<0&&(t=this.prefDefault),this.area=Math.round(t||0),this.electCompany=this.getElectCompany(this.area),D6.Unit.price.electricity=D6.Unit.defaultPriceElectricity*this.electCompanyPrice[this.electCompany],D6.Unit.co2.electricity=this.getCo2Unit(this.electCompany),D6.Unit.co2.nightelectricity=D6.Unit.co2.electricity,D6.Unit.co2.sellelectricity=D6.Unit.co2.electricity,this.airconFactor_mon=D6.accons.getArray(this.area),this.heatFactor_mon=D6.acload.getArray(this.area),this.plusHeatFactor_mon=D6.acadd.getArray(this.area),this.averageTemplature=this.getTemplature(this.area),this.unitPVElectricity=1e3*this.getPVElectricity(this.area)/3.6,this.heatingLevel=this.getHeatingLevel(this.area),this.heatingLevel){case 1:seasonMonth={winter:8,spring:3,summer:1};break;case 2:seasonMonth={winter:6,spring:4,summer:2};break;case 3:seasonMonth={winter:5,spring:5,summer:2};break;case 5:seasonMonth={winter:3,spring:5,summer:4};break;case 6:seasonMonth={winter:2,spring:5,summer:5};break;case 4:default:seasonMonth={winter:4,spring:5,summer:3}}for(var i in this.averageCostEnergy=this.getAverageCostEnergy(e<=0?3:e,Math.floor(this.area),this.urban),this.averageCO2Energy=[],this.averageCostEnergy)this.averageCO2Energy[i]=D6.Unit.costToCons(this.averageCostEnergy[i],i)*D6.Unit.co2[i]},getAverageCons:function(e){var t=[0,0,0],s=this.energyCode2id(e),i=this.averageCostEnergy[e],a=this.getSeasonFactor(this.area);return t.winter=this.Unit.costToCons(i*a[0][s],e),t.spring=this.Unit.costToCons(i*a[1][s],e),t.summer=this.Unit.costToCons(i*a[2][s],e),t},getAverageCostSeason:function(e,t){var s=this.energyCode2id(e),i=(this.averageCostEnergy[e],this.getSeasonFactor(this.area));return avConst*i[seasonCode2id(t)][s]}},D6.Unit={co2:{electricity:.55,nightelectricity:.55,sellelectricity:.55,nagas:2.23,lpgas:5.98,kerosene:2.49,gasoline:2.32,lightoil:2.62,heavyoil:3,coal:6,biomass:0,hotwater:.06,waste:0,water:0,gas:2.23,car:2.32},defaultPriceElectricity:27,price:{electricity:27,nightelectricity:10,sellelectricity:30,nagas:150,lpgas:500,kerosene:80,gasoline:130,lightoil:100,heavyoil:80,coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:120,car:130},priceBase:{electricity:0,nightelectricity:2100,sellelectricity:0,nagas:1e3,lpgas:1e3,kerosene:0,gasoline:0,lightoil:0,heavyoil:0,coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:800,car:0},name:{electricity:"electricity",nightelectricity:"night electricity",sellelectricity:"sell electricity",nagas:"natural gas",lpgas:"LP gas",kerosene:"kerosene",gasoline:"gas",lightoil:"light oil",heavyoil:"heavy oil",coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:"natural gas",car:"gas"},unitChar:{electricity:"kWh",nightelectricity:"kWh",sellelectricity:"kWh",nagas:"m3",lpgas:"m3",kerosene:"L",gasoline:"L",lightoil:"L",heavyoil:"L",coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:"m3",car:"L"},calorie:{electricity:860,nightelectricity:860,sellelectricity:860,nagas:11e3,lpgas:36e3,kerosene:8759,gasoline:8258,lightoil:9117,heavyoil:9e3,coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:11e3,car:8258},jules:{electricity:9.6,nightelectricity:9.6,sellelectricity:9.6,nagas:46,lpgas:60,kerosene:38,gasoline:38,lightoil:38,heavyoil:38,coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:45,car:38},costToCons:function(e,t,s,i){var a;if(void 0===i&&(i=0),-1!=e&&""!=e||(a=""),"electricity"!=t||null==typeof D6.area.elecPrice)a=e<2*D6.Unit.priceBase[t]?e/D6.Unit.price[t]/2:(e-D6.Unit.priceBase[t])/D6.Unit.price[t];else{(s<0||!s)&&(s=D6.consShow.TO.allDenka?3:1);var o=D6.area.elecPrice[s];a=(e-i*o[4]-o[3])/((o[1]+o[2])/2)}return a},consToCost:function(e,t,s,i){var a;if(-1!=e&&""!=e||(a=""),"electricity"!=t||null==typeof D6.area.elecPrice)a=e*D6.Unit.price[t];else{(s<0||!s)&&(s=D6.consShow.TO.allDenka?3:1);var o=D6.area.elecPrice[s];(a=i*o[4]+e*(o[1]+o[2])/2)>2*o[3]?a-=o[3]:a/=2}return a},consToEnergy:function(e,t){return-1!=e&&""!=e||"",e*D6.Unit.jules[t]/1e6}},(D6=D6||{}).object=function(e){var t=D6.object.func;t.prototype=e;for(var s=new t,i=arguments.length,a=1;a<i;++a)for(var o in arguments[a])s[o]=arguments[a][o];return s},D6.object.func=function(){},D6.patch=function(e,t){for(var s in t)e[s]=t[s];return e},(D6=D6||{}).Energy={electricity:0,nightelectricity:0,sellelectricity:0,nagas:0,lpgas:0,kerosene:0,gasoline:0,lightoil:0,heavyoil:0,coal:0,biomass:0,hotwater:0,waste:0,water:0,gas:0,car:0,co2:0,jules:0,cost:0,clear:function(){for(var e in D6.Unit.co2)this[e]=0;this.co2=0,this.jules=0,void(this.cost=0)!==typeof this.subID&&0!=this.subID&&(1==D6.viewparam.countfix_pre_after?this.mesTitlePrefix=this.countCall+this.subID:this.mesTitlePrefix=this.subID+this.countCall)},calcCO2:function(){for(var e in this.co2=0,D6.Unit.co2)this.co2+=this[e]*D6.Unit.co2[e]},calcJules:function(){for(var e in this.jules=0,D6.Unit.co2)this.jules+=this[e]*D6.Unit.jules[e]},calcCost:function(){for(var e in this.cost=0,D6.Unit.co2)this.cost+=this[e]*D6.Unit.price[e]},multiply:function(e){for(var t in D6.Unit.co2)this[t]*=e;this.co2*=e,this.jules*=e,this.cost*=e},multiplyArray:function(e){for(var t in D6.Unit.co2)this[t]*=e[t];this.calcCO2(),this.calcJules(),this.calcCost()},copy:function(e){for(var t in D6.Unit.co2)this[t]=e[t];this.co2=e.co2,this.jules=e.jules,this.cost=e.cost,this.endEnergy=e.endEnergy},sub:function(e){for(var t in D6.Unit.co2)this[t]-=e[t];this.co2-=e.co2,this.jules-=e.jules,this.cost-=e.cost,this.endEnergy-=e.endEnergy},add:function(e){for(var t in D6.Unit.co2)this[t]+=e[t];this.co2+=e.co2,this.jules+=e.jules,this.cost+=e.cost,this.endEnergy+=e.endEnergy},isSame:function(e){var t=!0;for(var s in D6.Unit.co2)if(this[s]!=e[s]){t=!1;break}return t}},D6.ConsBase=D6.object(D6.Energy),D6.ConsBase.init=function(){this.measures=[],this.title="",this.consName="consXX",this.consCode="",this.subID=0,this.groupID=0,this.inputGuide="",this.consShow=[],this.sumCons="",this.sumCons2="",this.sumConsName="",this.sumCons2Name="",this.partCons=[],this.partCons2=[],this.partConsName="",this.partCons2Name="",this.residueCalc="yes",this.performance="",this.mainSource="",this.co2Original="",this.costOriginal="",this.julesOriginal="",this.color="",this.total=!1,this.orgCopyNum=0,this.addable="",this.precalc=function(){this.clear()},this.calc=function(){this.clear()},this.calc2nd=function(){},this.calcAdjust=function(e){this.multiplyArray(e),this.calcAdjustStrategy(e)},this.calcAdjustStrategy=function(e){},this.consSumMonth=function(e,t){for(var s in Unit.co2)this.i+=e.i*t;this.co2+=e.co2*t,this.cost+=e.cost*t},this.calcMeasure=function(){},this.calcMeasureInit=function(){for(var e in this.measures)this.measures[e].setzero()},this.addReductionMargin=function(e,t,s){var i,a,o;if(this.add(e),this.calcCO2(),this.calcCost(),this.calcJules(),""==s&&(s=t),this.sumConsName!=s&&this.sumConsName!=t&&(i=this.sumCons)&&(i[this.subID]?i[this.subID].addReductionMargin(e,t,this.consName):i.addReductionMargin(e,t,this.consName)),""!=this.sumCons2Name&&this.sumCons2Name!=s&&this.sumCons2Name!=t&&(i=this.sumCons2)&&(i[this.subID]?i[this.subID].addReductionMargin(e,t,this.consName):i.addReductionMargin(e,t,this.consName)),"TO"!=this.consCode){for(a in o=!1,this.partCons)this.partCons[a].consName!=s&&this.partCons[a].consName!=t||(o=!0);for(a in!o&&0<this.partCons.length&&this.addReductionMargin2Part(this.partCons,e,t,this.consName),o=!1,this.partCons2)this.partCons2[a].consName!=s&&this.partCons2[a].consName!=t||(o=!0);!o&&0<this.partCons2.length&&this.addReductionMargin2Part(this.partCons2,e,t,this.consName)}},this.addReductionMargin2Part=function(e,t,s,i){var a,o=D6.object(D6.Energy);if(1<e.length){var n=0;for(a in e)isNaN(e[a].co2)||(n+=e[a].co2);if(1<=e[0].orgCopyNum&&e[0].subID!=e[1].subID)for(a in e)0<e[a].co2&&(o.copy(t),o.multiply(e[a].co2/n),e[a].addReductionMargin(o,s,this.consName));else for(a in e)if(0<e[a].co2)if(e[a].consAddSet)for(pmes in this.measures){var c=this.measures[pmes];c.selected&&c[e[a].consName]&&(o.copy(c[e[a].consName]),o.sub(e[a]),e[a].addReductionMargin(o,s,this.consName))}else o.copy(t),o.multiply(e[a].co2/n),e[a].addReductionMargin(o,s,this.consName)}},this.input=function(e,t){var s;if(D6.averageMode&&-1==D6.scenario.defCalcAverage.indexOf(e))return t;var i=D6.doc.data[e];return void 0===i||-1==i||""===i?s=t:(s=i,"Number"==D6.scenario.defInput[e.substr(0,4)].varType&&(s=parseFloat(s))),s},this.input2seasons=function(e,t,s){var i=[],a=this.input(e,-1),o=this.input(t,a);return-1==a&&(a=-1==o?o=s:o),i[0]=a,i[1]=o,i},this.getEquipParameters=function(e,t,s,i){var a={},o=s[0];for(var n in s)if(!(t>1.001*s[n])){o=s[n];break}var c=i[o],r=-9999,h=99999;for(var u in c)e<=u?u<h&&(h=u):r<u&&(r=u);for(var l in c[r])a[l]=((h-e)*c[r][l]+(e-r)*c[h][l])/(h-r);return a},this.setsubID=function(e){this.subID=e,this.titleList&&(this.title=this.titleList[e])},this.isSelected=function(e){return!!this.measures[e]&&this.measures[e].selected},this.getIndex=function(e,t){for(var s=0;s<t.length;s++)if(e<t[s])return s;return t.length}},D6.ConsBase.init(),D6.MeasureBase=D6.object(D6.Energy),D6.MeasureBase.init=function(){this.mesID=0,this.mesdefID=0,this.subID=0,this.groupID=0,this.measureName="",this.cons="",this.selected=!1,this.available=!1,this.reduceRate=0,this.title="",this.titleShort="",this.priceNew=0,this.priceOrg=0,this.lifeTime=0,this.lifestyle=2,this.def="",this.costUnique,this.co2Change=0,this.co2ChangeW1=0,this.co2ChangeW2=0,this.costOtherChange=0,this.costChange=0,this.costTotalChange=0,this.payBackYear=0,this.co2ChangeOriginal=0,this.costOriginal=0,this.costChangeOriginal=0,this.costTotalChangeOriginal=0,this.co2ChangeSumup=0,this.costSumup=0,this.costChangeSumup=0,this.costTotalChangeSumup=0,this.advice="",this.joyfull="",this.figNum=0,this.hojoGov=0,this.genzeiGov=0,this.hojoInfo=""},D6.MeasureBase.init(),D6.MeasureBase.Constructor=function(e,t,s){this.def=t,this.measureName=t.name,this.cons=e,this.mesID=s,this.mesdefID=t.mid,this.title=t.title,this.titleShort=t.titleShort,this.lifeTime=t.lifeTime,this.priceOrg=t.price,this.groupID=this.cons.groupID,this.lifestyle=t.lifestyle,this.advice=t.advice,this.joyfull=t.joyfull,this.figNum=t.figNum},D6.MeasureBase.clearMeasure=function(){this.priceNew=0,this.lifeTime=0,this.co2Change=0,this.co2ChangeW1=0,this.co2ChangeW2=0,this.costChange=0,this.payBackYear=0,this.costOtherChange=0,this.costTotalChange=0,this.co2ChangeSumup=0,this.costChangeSumup=0,this.costTotalChangeSumup=0,this.available=!1,this.costUnique=0,this.priceOrg=0,this.clear()},D6.MeasureBase.calcSave=function(){this.calcCO2(),this.co2Change=this.co2-this.cons.co2,this.co2ChangeW1=this.co2Change*this.def.easyness*(1==this.def.lifestyle?2:1),this.co2ChangeW2=this.co2Change*this.def.easyness*this.def.easyness*(1==this.def.lifestyle?3:1),0==this.costUnique||isNaN(this.costUnique)?this.calcCost():this.cost=this.costUnique,this.costChange=0==this.cost?0:this.cost-this.cons.cost,this.def.easyness<0&&(this.co2Change=0,this.costChange=0),0==this.priceNew&&(this.priceNew=this.priceOrg),0<=this.priceNew&&0<this.lifeTime?(this.costTotalChange=this.costChange+this.priceNew/this.lifeTime/12,0<this.costChange?this.payBackYear=999:this.payBackYear=Math.min(Math.round(-this.priceNew/this.costChange/12),999)):this.costTotalChange=this.costChange,D6.isOriginal&&(this.co2ChangeOriginal=this.co2Change,this.costChangeOriginal=this.costChange,this.costTotalChangeOriginal=this.costTotalChange,this.co2ChangeW1Original=this.co2ChangeW1,this.co2ChangeW2Original=this.co2ChangeW2)},D6.MeasureBase.setzero=function(){this.copy(this.cons)},D6.MeasureBase.calcReduceRate=function(e){this.copy(this.cons),this.multiply(1-e)},D6.MeasureBase.calcReduceRateOne=function(e,t){this[e]=this.cons[e],this.multiply(1-t)},D6.MeasureBase.calcReduceRateWithParts=function(e,t){for(var s in this.calcReduceRate(e),t)this[t[s].consName]=D6.object(D6.Energy),this[t[s].consName].copy(t[s]),this[t[s].consName].multiply(1-e)},D6.MeasureBase.addReduction=function(){var e=D6.object(D6.Energy);e.copy(this),e.sub(this.cons),this.cons.addReductionMargin(e,this.cons.consName)},D6.MeasureBase.calc=function(){this.clearMeasure(),cons.calcMeasure(this.measureName),this.calcSave()},D6.MeasureBase.measureSumMonth=function(e,t){for(var s in Unit.co2)this[s]+=e[s]*t;this.co2+=e.co2*t,this.co2Change+=e.co2Change*t,this.co2ChangeOriginal+=e.co2ChangeOriginal*t,this.cost+=e.cost*t,this.costChange+=e.costChange*t,this.costTotalChange+=e.costTotalChange*t,this.costOriginal+=e.costOriginal*t,this.costChangeOriginal+=e.costChangeOriginal*t,this.costTotalChangeOriginal+=e.costTotalChangeOriginal*t},D6.doc={data:[],equip:[],clear:function(e){var t;t=this.data.AreaOrg,this.data=new Array,this.data.AreaOrg=t,this.data.Area=t},serialize:function(){var e="",t="",s=0,i=0,a=this.data;for(s in a)if(D6.scenario.defInput[s.substr(0,4)].defaultValue!=a[s]){if(t=""+a[s],"string"==typeof a[s]){for(;-1!=t.indexOf(" ");)i=t.indexOf(" "),t=t.substring(0,i-1)+"_"+t.substring(i+1,2e3);for(;-1!=t.indexOf(",");)i=t.indexOf(","),t=t.substring(0,i-1)+"~"+t.substring(i+1,2e3)}e=e+s+"="+t+","}for(s in D6.logicList)1<=D6.logicList[s].orgCopyNum&&(e+=s+"="+D6.logicList[s].orgCopyNum+",");var o="";for(i=0;i<D6.measureList.length;i++)D6.measureList[i].selected&&(t="000"+D6.measureList[i].mesdefID,tempg="00"+D6.measureList[i].subID,o+=t.substr(-3)+tempg.substr(-2),tempi="00000000"+D6.measureList[i].priceNew,o+=tempi.substr(-8),0<D6.measureList[i].costChangeOriginal?o+="9":o+="8",o+=(t="0000000"+Math.abs(Math.round(D6.measureList[i].costChangeOriginal))).substr(-7),0<D6.measureList[i].co2ChangeOriginal?o+="9":o+="8",o+=(t="00000"+Math.abs(Math.round(D6.measureList[i].co2ChangeOriginal))).substr(-5));return e+="mesSelId="+o},loadDataSet:function(e,t){var s,i,a,o,n,c,r,h,u=this.data,l=D6.scenario.defInput,p=0,m=0;for(s=e.split(","),c=0;c<s.length;c++)if(s[c]?(n=(o=(i=s[c].split("="))[0]).substr(0,4),a=i[1]):o="dummy",D6.logicList[o])parseInt(a)&&parseInt(a)<100&&(t||(D6.logicList[o].orgCopyNum=parseInt(a)));else if(l[n])switch(l[n].varType){case"Number":u[o]=parseFloat(a);break;case"String":for(r=a.indexOf("_");-1!=r;)r=(a=a.substring(0,r)+" "+a.substring(r+1,200)).indexOf("_");for(r=a.indexOf("~");-1!=r;)r=(a=a.substring(0,r)+","+a.substring(r+1,200)).indexOf("~");for(r=a.indexOf('"');-1!=r;)r=(a=a.substring(0,r)+a.substring(r+1,200)).indexOf('"');u[o]=a;break;default:if("mesSelId"==o)for(h=a,r=0;r<h.length;r+=27){p=parseInt(h.substr(r,3)),m=parseInt(h.substr(r+3,2));for(var D=0;D<D6.measureList.length;D++)if(D6.measureList[D].mesID==p&&D6.measureList[D].subID==m){D6.measureList[D].seleted=!0;break}}else"true"==a?u[o]=!0:"false"==a&&(u[o]=!1)}return h}},(D6=D6||{}).consList=[],D6.consListByName=[],D6.consShow=[],D6.measureList=[],D6.monthly=[],D6.resMeasure=[],D6.mesCount=0,D6.consCount=0,D6.average={consList:""},D6.isOriginal=!0,D6.sortTarget="co2ChangeOriginal",D6.viewparam={},D6.debugMode=!1,D6.constructor=function(e,t,s){D6.setscenario(e,t,s)},D6.calculateAll=function(){D6.calcCons(),D6.calcAverage(),D6.calcMeasures(-1)},void 0===atob){function atob(e){return e}function btoa(e){return e}}(D6=D6||{}).calcMonthly=function(e,t,s,i,a){var o,n=[0,0,0,1,1,1,2,2,2,1,1,0],c=[0,0,0],r=[0,0,0],h=[0,0,0],u=[0,0,0],l=!0,p=0,m=0;for(o=0;o<12;o++)-1!=s[o]&&(c[n[o]]+=s[o],h[n[o]]++,p+=s[o],m++,l=!1);0<h[0]&&0<h[1]&&0<h[2]?(r[0]=c[0]/h[0],r[1]=c[1]/h[1],r[2]=c[2]/h[2]):-1!=t[0]&&-1!=t[1]&&-1!=t[2]?(r[0]=t[0],r[1]=t[1],r[2]=t[2]):r=i||[1,1,1];var D=4*r[0]+5*r[1]+3*r[2];if(0!=D&&(r[0]*=12/D,r[1]*=12/D,r[2]*=12/D),-1==t[0]&&-1==t[1]&&-1==t[2])6<m&&(e=D6.Unit.consToCost(p/m,a)),t[0]=e*r[0],t[1]=e*r[1],t[2]=e*r[2];else{l=!1;var d=0,g=0;for(o=0;o<3;o++)0!=r[o]?-1!=t[o]?(d+=t[o]/r[o],g++):1<=h[o]&&(t[o]=D6.Unit.consToCost(c[o]/h[o],a),d+=t[o]/r[o],g++):g++;e=d/=g,t[0]=-1==t[0]?e*r[0]:t[0],t[1]=-1==t[1]?e*r[1]:t[1],t[2]=-1==t[2]?e*r[2]:t[2]}for(u[0]=D6.Unit.costToCons(t[0],a),u[1]=D6.Unit.costToCons(t[1],a),u[2]=D6.Unit.costToCons(t[2],a),o=0;o<12;o++)-1==s[o]&&(sim=n[(o+12-1)%12],si=n[o],sip=n[(o+1)%12],s[o]=(t[sim]+t[si]+t[sip])/3);var f=[];return f.ave=e,f.season=t,f.seasonCons=u,f.monthly=s,f.noConsData=l,f},(D6=D6||{}).getAllResult=function(e){var t=[];e&&(D6.logicList[e]||(e="consTotal"),this.nowConsPageName=e),e=this.nowConsPageName;var s=D6.consListByName[e][0].consCode;return t.common=D6.getCommonParameters(),t.monthly=this.getMonthly(),t.average=this.getAverage(s),t.average_graph=this.getAverage_graph(),t.itemize=this.getItemize(s),t.itemize_graph=this.getItemizeGraph(s),t.measure=this.getMeasure(e),t},D6.getAverage=function(e){var t=[];return t.you=12*D6.consShow[e].co2Original,t.after=12*D6.consShow[e].co2,t.av=12*D6.average.consList[e].co2,t.youc=12*D6.consShow[e].costOriginal,t.afterc=12*D6.consShow[e].cost,t.avc=12*D6.average.consList[e].cost,t.rank100=D6.rankIn100(t.you/t.av),t.afterrank100=D6.rankIn100(t.after/t.av),t.samehome=D6.scenario.defSelectValue.sel021[Math.max(1,D6.doc.data.i021)],t.sameoffice=D6.scenario.defSelectValue.sel001[Math.max(1,D6.doc.data.i001)],t.consCode=e,t},D6.getAverage_graph=function(){var e=[];return e.cost=[],e.co2=[],e.cost[1]=D6.area.averageCostEnergy,e.co2[1]=D6.area.averageCO2Energy,e.co2[1].total=e.co2[1].electricity+e.co2[1].gas+e.co2[1].kerosene+e.co2[1].car,e.cost[0]=[],e.cost[0].electricity=D6.consTotal.priceEle,e.cost[0].gas=D6.consTotal.priceGas,e.cost[0].kerosene=D6.consTotal.priceKeros,e.cost[0].car=D6.consTotal.car*D6.Unit.price.gasoline,e.co2[0]=[],e.co2[0].electricity=D6.consTotal.electricity*D6.Unit.co2.electricity,e.co2[0].gas=D6.consTotal.gas*D6.Unit.co2.gas,e.co2[0].kerosene=D6.consTotal.kerosene*D6.Unit.co2.kerosene,e.co2[0].car=D6.consTotal.car*D6.Unit.co2.gasoline,e.co2[0].total=D6.consTotal.co2Original,e},D6.getItemize=function(e){var t,s=[],i=0;for(var a in D6.consList)t=D6.consList[a],s[i]=[],s[i].title=t.title,s[i].consName=t.consName,s[i].subID=t.subID,s[i].sumConsName=t.sumConsName,s[i].sumCons2Name=t.sumCons2Name,s[i].countCall=t.countCall,s[i].co2=t.co2,s[i].co2Total=D6.consShow.TO.co2,s[i].electricity=t.electricity,s[i].nightelectricity=t.nightelectricity,s[i].gas=t.gas,s[i].water=t.water,s[i].coal=t.coal,s[i].hotwater=t.hotwater,s[i].kerosene=t.kerosene,s[i].car=t.car,s[i].color=t.color,i++;return s},D6.getItemizeGraph=function(e,t){var u="other";e&&(this.nowConsCode=e),e=this.nowConsCode,t&&(this.nowSortTarget=t);var l={co2:{sort:"co2",title:"kg",round:1,divide:1},energy:{sort:"jules",title:"GJ",round:1,divide:1e3},money:{sort:"cost",title:"yen",round:10,divide:1}}[(t=this.nowSortTarget)||"co2"],s=[],i=function(e,t,s,i){var a=l.sort;s&&(a+="Original");var o=0,n=[],c=0;if("TO"==i){for(var r in e)"TO"!=r&&""!=r&&(n[c]={},n[c].compare=t,n[c].ratio=Math.round(e[r][a]/e[i][a]*1e3)/10,n[c][l.title]=Math.round(12*e[r][a]/l.divide*l.round)/l.round,n[c].item=e[r].title,c++,o+=e[r][a]);n[c]={},n[c].compare=t,n[c].ratio=Math.round((e.TO[a]-o)/e.TO[a]*1e3)/10,n[c][l.title]=Math.round(12*(e.TO[a]-o)/l.divide*l.round)/l.round,n[c].item=u}else if(e[i].partCons){var h=e[i].partCons;for(var r in h)n[c]={},n[c].compare=t,n[c].ratio=Math.round(h[r][a]/e[i][a]*1e3)/10,n[c][l.title]=Math.round(12*h[r][a]/l.divide*l.round)/l.round,n[c].item=h[r].title+(0<h[r].subID?":"+(1==D6.viewparam.countfix_pre_after?h[r].countCall+h[r].subID:h[r].subID+h[r].countCall):""),c++,o+=h[r][a];n[c]={},n[c].compare=t,n[c].ratio=Math.round((e[i][a]-o)/e[i][a]*1e3)/10,n[c][l.title]=Math.round(12*(e[i][a]-o)/l.divide*l.round)/l.round,n[c].item=u}else n[c]={},n[c].compare=t,n[c].ratio=100,n[c][l.title]=Math.round(12*e[i][a]/l.divide*l.round)/l.round,n[c].item=e[i].title,c++;return n},a=["you","after","average"],o="";o=1==D6.targetMode?D6.scenario.defSelectValue.sel021[D6.area.area]:D6.scenario.defSelectValue.sel001[Math.max(1,D6.doc.data.i001)];var n=i(D6.consShow,a[0],!0,e);Array.prototype.push.apply(n,i(D6.consShow,a[1],!1,e)),Array.prototype.push.apply(n,i(D6.average.consList,a[2],!1,e));var c=[];for(var r in D6.consShow)"TO"!=r&&("TO"!=e&&r!=e||c.push({title:D6.consShow[r].title,target:D6.consShow[r][l.sort+"Original"],color:D6.consShow[r].color}));var h=[];if("TO"==e){for(var r in D6.ObjArraySort(c,"target","desc"),c)h.push(c[r].title);h.push(u)}else h.push(c.title);return s.data=n,s.yaxis=l.title,s.ord=h,s.clist=c,s.averageCaption=o,s.captions=a,s.consTitle=D6.consShow[e].title,s},D6.dataItemize=function(){var e,t=D6.consShow,s=new Array;new Array;for(e in t)"TO"!=t[e].consCode&&s.push(t[e]);return s.sortOn("co2",18),s.unshift(t.TO),s},D6.getMonthly=function(){for(var e,t=[],s={sort:"cost",title:"yen",round:1,divide:1},i=[{r:0,ene:"electricity",name:D6.Unit.name.electricity},{r:1,ene:"gas",name:D6.Unit.name.gas},{r:2,ene:"kerosene",name:D6.Unit.name.kerosene},{r:3,ene:"coal",name:D6.Unit.name.coal},{r:4,ene:"hotwater",name:D6.Unit.name.hotwater},{r:5,ene:"car",name:D6.Unit.name.car}],a=[],o=0,n=1;n<=12;n++)for(e=0;e<i.length;e++)D6.consShow.TO.monthlyPrice[i[e].ene]&&(a[o]=[],a[o].month=n,a[o][s.title]=Math.round(D6.consShow.TO.monthlyPrice[i[e].ene][n-1]/s.divide*s.round)/s.round,a[o].energyname=i[e].ene,o++);return t.data=a,t.yaxis=s.title,t},D6.getGid=function(e){return D6.logicList[e].groupID},D6.getCommonParameters=function(){var e=[];return e.co2Original=D6.consListByName.consTotal[0].co2Original,e.co2=D6.consListByName.consTotal[0].co2,e.costOriginal=D6.consListByName.consTotal[0].costOriginal,e.cost=D6.consListByName.consTotal[0].cost,e},D6.getInputPage=function(e,t){var s,i=[],a=[],o=[],n=[],c=[],r=[],h=0,u="",l="",p=[];for(var m in D6.scenario.defEasyQues){var D=D6.scenario.defEasyQues[m];for(var d in u=D.cname,a[D.cname]=D.title,o[D.cname]=[],p[D.cname]=[],n[D.cname]=[],c[D.cname]=[],r[D.cname]=[],c[D.cname][u]=[],r[D.cname][u]=[],D.ques)!(s=D6.scenario.defInput[D.ques[d]])&&D6.debugMode&&console.log("defEasyQues error no "+D.ques[d]+" in scenarioset"),n[D.cname][u]=D.title,"String"==s.varType?r[D.cname][u].push(this.createTextArea(D.ques[d])):r[D.cname][u].push(this.createComboBox(D.ques[d]))}for(var m in D6.consShow){var g=D6.consShow[m].consName;for(var d in a[g]=D6.consShow[m].title,o[g]=[],p[g]=[],n[g]=[],c[g]=[],r[g]={},D6.doc.data)if(s=D6.scenario.defInput[d.substr(0,4)],(l=D6.logicList[s.cons]).consName==g||l.sumConsName==g&&"consTotal"!=l.sumConsName||l.sumCons2Name==g&&"consTotal"!=l.sumCons2Name||l.inputDisp==g){if(4==d.length)h=0,u=l.consName;else{if(0==(h=d.substr(4,2)))continue;u=l.consName+h}if(null==n[g][u]&&(0==h?n[g][u]=l.title:1==D6.viewparam.countfix_pre_after?n[g][u]=l.countCall+(l.titleList?l.titleList[h]:h):n[g][u]=(l.titleList?l.titleList[h]:h)+l.countCall,c[g][u]=l.inputGuide,r[g][u]=[]),l.addable&&p[g].indexOf(l.consName)<0&&(p[g].push(l.consName),o[g].push({consName:l.consName,caption:l.addable})),e!=g)continue;"String"==s.varType?r[g][u].push(this.createTextArea(d)):r[g][u].push(this.createComboBox(d))}}return i.group=a,i.groupAddable=o,i.subgroup=n,i.subguide=c,i.combos=r,i.consName=e,D6.logicList[e]||(e="consTotal"),i.title=D6.logicList[e].title,i.subName=t,i},D6.createComboBox=function(e,t){var s="",i="sel"+e.substr(1,3),a=e.substr(0,4),o=D6.scenario.defSelectValue[i],n=D6.scenario.defSelectData[i];if(!n||""==n[0])return this.createTextArea(e,t);var c=o.length,r=D6.doc.data[e],h=-1!=r?" class='written' ":"",u=D6.scenario.defInput[a].title;if(""==u||"#"==u.substr(0,1))return"";t||(s+="<tr><td class='qtitle' width='50%'>",s+=u,s+="<div class='tool-tips'>"+D6.scenario.defInput[a].text+(D6.debugMode?" "+e:"")+"</div>",s+="</td><td>"),s+="<select title='"+D6.scenario.defInput[a].title+"' name='"+e+"' id='"+e+"'",s+=" onchange='inchange(\""+e+"\");'",s+=h,s+=" >";for(var l=0;l<c;l++)o[l]&&(s+="<option value='"+n[l]+"' ",n[l]==r&&(s+="selected "),s+=">"+(D6.debugMode?n[l]+" ":"")+o[l]+"</option>");return s+="</select>",t||(s+="</td></tr>"),s},D6.createTextArea=function(e,t){var s="",i=(e.substr(1,3),e.substr(0,4)),a=D6.doc.data[e],o=""!=a&&-1!=a?" class='written' ":"",n="Number"==D6.scenario.defInput[i].varType;return t||(s+="<tr><td class='qtitle'>",s+=D6.scenario.defInput[i].title,s+="<div class='tool-tips' >"+D6.scenario.defInput[i].text+(D6.debugMode?" "+e:"")+"</div>",s+="</td><td>"),s+="<input type='text' title='"+D6.scenario.defInput[i].title+"' name='"+e+"' id='"+e+"' "+o+(n?"style='text-align:right;'":"")+" onchange='inchange(\""+e+"\");'"+(a&&-1!=a?" value='"+this.escapeHtml(a)+"'":"")+">",t||(s+=D6.scenario.defInput[i].unit+"</td></tr>"),s},D6.tfHandlerCombo=function(t){return function(e){Input[t]=e.target.value,e.target.removeEventListener(Event.ENTER_FRAME,arguments.callee)}},D6.nowQuesCode=0,D6.nowQuesID=-1,D6.quesOrder=[],D6.getFirstQues=function(e,t){if(quesOrder=[],"easy01"==e)Array.isArray(t)?quesOrder=t:quesOrder=D6.scenario.defQuesOrder;else for(var s in D6.doc.data)D6.scenario.defInput[s.substr(0,4)].cons==t&&quesOrder.push(s);return nowQuesID=0,nowQuesCode=quesOrder[nowQuesID],this.getQues(nowQuesCode)},D6.getNextQues=function(){return nowQuesID++,nowQuesCode=quesOrder[nowQuesID],this.getQues(nowQuesCode)},D6.getPrevQues=function(){return nowQuesID--,nowQuesID<0&&(nowQuesID=0),nowQuesCode=quesOrder[nowQuesID],this.getQues(nowQuesCode)},D6.getQues=function(e){if(ret={},this.isEndOfQues())ret.info="end";else{ret.info="continue",ret.id=e,ret.numques=quesOrder.length,ret.nowques=nowQuesID+1;var t=D6.scenario.defInput[e.substr(0,4)];ret.title=t.title,ret.text=t.text,ret.unit=t.unit;var s=t.inputType;ret.defSelectValue=D6.scenario.defSelectValue[s],ret.defSelectData=D6.scenario.defSelectData[s],ret.selected=D6.doc.data[e],ret.consTitle=D6.logicList[t.cons].title}return ret},D6.getQuesList=function(){var e=[];return e.queslist=D6.doc.data,e},D6.isEndOfQues=function(){var e=!1;return nowQuesID+1>quesOrder.length&&(e=!0),e},D6.escapeHtml=function(e){var t,s={"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"},i="[";for(var a in s)s.hasOwnProperty(a)&&(i+=a);return i+="]",t=new RegExp(i,"g"),function(e){return(e=null==e?"":""+e).replace(t,function(e){return s[e]})}}(String),D6.getMeasureDetail=function(e){var t=[],s=D6.measureList[e];return t.title=s.title,t.titleShort=s.titleShort,t.measureName=s.measureName,t.mesID=s.mesID,t.groupID=s.groupID,t.consName=s.cons.consName,t.figNum=s.figNum,t.advice=s.advice,t.joyfull=s.joyfull,t.total=s.cons.total,t.co2Total=D6.consShow.TO.co2Original,t.selected=s.selected,t.co2=s.co2,t.co2Change=s.co2Change,t.co2ChangeOriginal=s.co2ChangeOriginal,t.jules=s.jules,t.cost=s.cost,t.costChange=s.costChange,t.costChangeOriginal=s.costChangeOriginal,t.costTotalChange=s.costTotalChange,t.costTotalChangeOriginal=s.costTotalChangeOriginal,t.costUnique=s.costUnique,t.priceOrg=s.priceOrg,t.priceNew=s.priceNew,t.payBackYear=s.payBackYear,t.lifeTime=s.lifeTime,t.electricity=s.electricity,t.gas=s.gas,t.coal=s.coal,t.hotwater=s.hotwater,t.car=s.car,t.kerosene=s.kerosene,t.water=s.water,t},D6.getMeasure=function(e,t,s){void 0===t&&(t=1e8),void 0===s&&(s=0);var i,a=[],o=0,n=[];for(var c in D6.measureList)n.push(D6.measureList[c]);for(var r in D6.ObjArraySort(n,D6.sortTarget),n)if(c=n[r].mesID,""!=(i=D6.measureList[c]).title&&"#"!=i.title.substr(0,1)){var h=D6.consListByName[e][0].partCons,u=!1;for(var l in h)i[h[l].consName]&&(u=!0);i[e]&&(u=!0),i.selected&&1==s||i.priceNew>t||(a[o]=[],a[o].mesID=i.mesID,a[o].title=i.title,a[o].selected=i.selected,a[o].consName=e,a[o].groupID=i.groupID,a[o].measureName=i.measureName,a[o].consconsName=i.cons.consName,a[o].conssumConsName=i.cons.sumConsName,a[o].conssumCons2Name=i.cons.sumCons2Name,a[o].co2Change=i.co2Change,a[o].co2ChangeOriginal=i.co2ChangeOriginal,a[o].costChangeOriginal=i.costChangeOriginal,a[o].conssubID=i.cons.subID,a[o].consmesTitlePrefix=i.cons.mesTitlePrefix,a[o].relation=u,a[o].payBackYear=i.payBackYear,a[o].lifeTime=i.lifeTime,a[o].lifestyle=i.lifestyle,i.cons.color||"consTOTAL"==i.cons.consName?a[o].color=i.cons.color:a[o].color=i.cons.sumCons.color,o++)}return a},D6.getDemandGraph=function(){var e={},t={},s=[];for(var i in D6.scenario.defInput)0<D6.scenario.defInput[i].demand&&(e[D6.scenario.defInput[i].cons]=[]);for(var a in D6.doc.data){var o=D6.scenario.defInput[a.substr(0,4)];if(e[o.cons]){var n=parseInt(a.substr(4,2));e[o.cons][n]||(e[o.cons][n]=[]),e[o.cons][n][o.demand]=D6.doc.data[a]}}var c=[],r=0,h="",u="",l=0,p=1,m=0,D=24,d=0,g="";for(i in e)for(a in d++,h=D6.logicList[i].addable,e[i])if(u=e[i][a][4]?e[i][a][4]:a,l=e[i][a][1]&&0<e[i][a][1]?e[i][a][1]:e[i][a][2]&&0<e[i][a][2]?e[i][a][2]/1e3:0,p=e[i][a][3]&&0<e[i][a][3]?e[i][a][3]:0,m=e[i][a][5]&&0<=e[i][a][5]?e[i][a][5]:0,D=e[i][a][6]&&0<=e[i][a][6]?e[i][a][6]:24,l*p!=0&&!(D<=m)){g=y(d);for(var f=0;f<24;f++)c[r]={},c[r].equip=h+"-"+(parseInt(u)?a:u),c[r].time=f,c[r].electricity_kW=m<=f&&f<D?Math.round(l*p*10)/10:0,s.push({title:c[r].equip,target:"electricity_kW",color:g}),r++}t.sumup=c,t.clist=s;var C=[];for(f=0;f<24;f++)C[f]={},C[f].equip="log",C[f].time=f,C[f].electricity_kW=D6.doc.data["i056"+(f+1)];return t.log=C,t;function y(e){var t=[100,100,100];for(var s in e<=3?t[e-1]=255:e<=6&&(t[e-4]=0),t)100==t[s]&&(t[s]=Math.floor(150*Math.random())+38);return"#"+(256*t[0]*256+256*t[1]+t[2]).toString(16)}},D6.getInputDemandSumup=function(){var e={},t={},s={},i={};for(var a in D6.scenario.defInput)0<D6.scenario.defInput[a].demand&&(e[D6.scenario.defInput[a].cons]=!0,t[D6.scenario.defInput[a].cons]={});var o="";for(var n in D6.doc.data){var c=D6.scenario.defInput[n.substr(0,4)];if(e[c.cons]){o=this.createComboBox(n,!0);var r=parseInt(n.substr(4,2));s[c.cons]=D6.consListByName[c.cons][0].addable,t[c.cons][r]||(t[c.cons][r]=[]),t[c.cons][r][c.demand]=o}}return i.data=t,i.title=s,i},D6.getInputDemandLog=function(){for(var e=[],t=0;t<24;t++)e[t]=this.createComboBox("i056"+(t+1),!0);return e},(D6=D6||{}).getEvaluateAxisPoint=function(e,t){var s={0:[0,"",""],1:[0,"",""],2:[0,"",""]},i=[];for(var a in D6.scenario.defEasyQues)if(D6.scenario.defEasyQues[a].cname==t){i=D6.scenario.defEasyQues[a].ques;break}if(""==i)return s;for(var o=0;o<3;o++){var n=0,c=0,r=0,h="",u=0,l="",p=0;for(var m in i){var D=D6.scenario.defInput[i[m]],d=D6.doc.data[i[m]],g=D["d"+(o+1)+"w"];""!=g&&(D["d"+(o+1)+"d"]*g,d!=D.defaultValue&&void 0!==d&&(n+=2*g,r<(p=d>=D["d"+(o+1)+"1t"]?D["d"+(o+1)+"1p"]*g:""!=D["d"+(o+1)+"2t"]&&d>=D["d"+(o+1)+"2t"]?D["d"+(o+1)+"2p"]*g:""!=D["d"+(o+1)+"3t"]&&d>=D["d"+(o+1)+"3t"]?D["d"+(o+1)+"3p"]*g:0)&&(r=p,h=D.title),p-2*g<u&&(u=p-2*g,l=D.title),c+=p))}s[o][0]=c/(0==n?1:n)*100,s[o][1]=h,s[o][2]=l}return s},(D6=D6||{}).setscenario=function(t,s,e){var i,a=!1;if("add"==t&&(a=!0),t||(t=[]),s||(s=[]),!a){for(var o in D6.scenario.setDefs(),D6.scenario.areafix(),e)e[o][2]&&(D6.scenario.defInput[e[o][0]][e[o][1]]=e[o][2]);D6.logicList=D6.scenario.getLogicList()}var n,c,r,h,u,l,p=D6.consList;for(n in D6.consCount=0,D6.logicList)c=D6.logicList[n],D6.consListByName[c.consName]=[],"consTotal"!=c.sumConsName&&"consTotal"!=c.consName||(p[D6.consCount]=c,D6.consShow[c.consCode]=p[D6.consCount],D6.consListByName[c.consName].push(p[D6.consCount]),D6.consCount++);for(n in D6.logicList)if("consTotal"!=(c=D6.logicList[n]).sumConsName&&"consTotal"!=c.consName)if(0==c.orgCopyNum)p[D6.consCount]=c,D6.consListByName[c.consName].push(p[D6.consCount]),D6.consCount++;else for(i=0;i<=c.orgCopyNum;i++)p[D6.consCount]=D6.object(c),p[D6.consCount].setsubID(i),D6.consListByName[c.consName].push(p[D6.consCount]),D6.consCount++;for(f=0;f<p.length;f++){for((r=p[f]).measures=[],r.partCons=[],r.sumCons=this.getTargetConsList(r.sumConsName),r.sumCons2=this.getTargetConsList(r.sumCons2Name),u=[],l=[],i=0;i<p.length;i++)(h=p[i]).sumConsName===r.consName&&(1<=h.orgCopyNum?1<=r.orgCopyNum?r.subID==h.subID&&(r.partConsName=h.consName,u.push(h)):(r.partConsName=h.consName,u.push(h)):u.push(h)),h.sumCons2Name==r.consName&&(1<=h.orgCopyNum?1<=r.orgCopyNum?r.subID==h.subID&&(r.partCons2Name=h.consName,l.push(h)):(r.partCons2Name=h.consName,l.push(h)):l.push(h));1<=u.length?r.partCons=u:r.partCons="",1<=l.length?r.partCons2=l:r.partCons2=""}for(f in this.mesCount=0,p)this.addMeasureEachCons(p[f]);var m,D=function(e){return""==e.cons||(t.length<=0?!(s.length<=0)&&!(0<=s.indexOf(e)):0<=t.indexOf(e))};for(m in D6.scenario.defInput)if(!D(m)){var d=D6.scenario.defInput[m];if(n=D6.logicList[d.cons])if(0<n.orgCopyNum)for(i=0;i<n.orgCopyNum;i++)D6.inSet(m+(i+1),d.defaultValue);else D6.inSet(m,d.defaultValue)}var g=[];if(D6.scenario.defEasyQues){for(var f in D6.scenario.defEasyQues[0].ques)D(D6.scenario.defEasyQues[0].ques[f])||g.push(D6.scenario.defEasyQues[0].ques[f]);for(f in D6.scenario.defEasyQues[0].ques=[],g)D6.scenario.defEasyQues[0].ques.push(g[f])}},D6.addMeasureEachCons=function(e){for(var t in D6.scenario.defMeasures)e.consName==D6.scenario.defMeasures[t].refCons&&(this.measureList[this.mesCount]=D6.object(D6.MeasureBase),this.measureList[this.mesCount].Constructor(e,D6.scenario.defMeasures[t],this.mesCount),e.measures[t]=this.measureList[this.mesCount],this.mesCount++)},D6.addConsSetting=function(e){var t="",s="",i=!1;for(t in D6.logicList){for(var a in s=D6.logicList[t].consAddSet)if(s[a]==e||t==e){for(var o in D6.logicList[t].orgCopyNum=D6.logicList[t].orgCopyNum+1,s)D6.logicList[s[o]].orgCopyNum=D6.logicList[s[o]].orgCopyNum+1;i=!0;break}if(i)break}i||(D6.logicList[e].orgCopyNum=D6.logicList[e].orgCopyNum+1)},(D6=D6||{}).calcCons=function(){var e;for(this.area.setCalcBaseParams(),e=0;e<D6.consList.length;e++)this.consList[e].precalc();for(e=0;e<D6.consList.length;e++)this.consList[e].calc(),this.consList[e].calcCO2();for(e=0;e<this.consList.length;e++)this.consList[e].calc2nd(),this.consList[e].calcCO2();for(this.calcConsAdjust(),e=0;e<this.consList.length;e++)this.consList[e].calcCost(),this.consList[e].calcJules(),this.isOriginal&&(this.consList[e].co2Original=this.consList[e].co2,this.consList[e].costOriginal=this.consList[e].cost,this.consList[e].julesOriginal=this.consList[e].jules)},D6.calcConsAdjust=function(){var e,t,s,i,a=D6.object(D6.Energy);D6.energyAdj=D6.object(D6.Energy);var o=!0,n="";for(e in this.consShow)if("consTotal"!=(i=this.consShow[e]).consName&&(a.clear(),1<=i.partCons.length)){for(n=i.partCons[0].consName,t=1;t<i.partCons.length;t++)a.add(i.partCons[t]),n!=i.partCons[t].consName&&(o=!1);if(a.calcCO2(),"no"==i.residueCalc)i.copy(a),i.add(i.partCons[0]),i.calcCO2();else if(a.co2>i.co2){for(t=1;t<=void 0;t++)i.partCons[t].multiply(i.co2/a.co2);i.partCons[0].clear()}else o?(a.sub(i),a.multiply(-1),i.partCons[0].copy(a)):(i.copy(a),i.add(i.partCons[0]),i.calcCO2())}for(e in a.clear(),this.consShow)if("TO"!=e)for(s in D6.Unit.co2)a[s]+=this.consShow[e][s];var c=this.consShow.TO.noConsData;if(a.electricity+=.1*this.consShow.TO.electricity,energyAdj=[],c){for(s in D6.Unit.co2)"electricity"==s?this.consShow.TO[s]<a[s]&&(this.consShow.TO[s]=a[s]):this.consShow.TO[s]=a[s];this.consShow.TO.calcCO2()}else{for(s in D6.Unit.co2)0==a[s]?this.energyAdj[s]=1:(this.energyAdj[s]=this.consShow.TO[s]/a[s],void 0!==this.consShow.TO.noPriceData[s]&&this.consShow.TO.noPriceData[s]&&(this.energyAdj[s]<.5&&(this.consShow.TO[s]*=.5/this.energyAdj[s],this.energyAdj[s]=.5),2<this.energyAdj[s]&&"electricity"!=s&&(this.consShow.TO[s]*=2/this.energyAdj[s],this.energyAdj[s]=2)),this.energyAdj[s]="electricity"!=s?Math.max(.2,Math.min(1.5,this.energyAdj[s])):Math.max(.3,Math.min(3,this.energyAdj[s])));for(e in this.consList)"consTotal"!=this.consList[e].consName&&this.consList[e].calcAdjust(this.energyAdj)}},D6.getTargetConsList=function(e){var t,s,i=0,a=new Array;if(""!=e){for(t=0;t<this.consList.length;t++)this.consList[t].consName==e&&(a[i++]=this.consList[t]);s=1==a.length?a[0]:a}return s},D6.getGid=function(e){return D6.logicList[e].groupID},D6.getCommonParameters=function(){var e=[];return e.co2Original=D6.consListByName.consTotal[0].co2Original,e.co2=D6.consListByName.consTotal[0].co2,e.costOriginal=D6.consListByName.consTotal[0].costOriginal,e.cost=D6.consListByName.consTotal[0].cost,e},(D6=D6||{}).calcAverage=function(){for(var e in D6.averageMode=!0,this.calcCons(),this.average.consList={},this.consShow)this.average.consList[e]={},this.average.consList[e].co2=this.consShow[e].co2,this.average.consList[e].cost=this.consShow[e].cost,this.average.consList[e].jules=this.consShow[e].jules,this.average.consList[e].title=this.consShow[e].title;D6.averageMode=!1},D6.rankIn100=function(e){var t;return e<=0&&(e=.1),(t=Math.log(e))<-.5?Math.max(1,Math.round((t+1)/.5*10)):t<.5?Math.round((t+.5)/1*80+10):Math.min(100,Math.round((t-.5)/1*10)+90)},(D6=D6||{}).calcMeasures=function(e){var t,s,i,a,o,n=[];for(o in this.measureList)n[this.measureList[o].mesID]=this.measureList[o].selected;for(t=this.clearSelectedMeasures(e),s=0;s<t.length;s++)a=i=t[s].mesID,o=this.measureList[a],n[i]&&!o.selected&&(o.selected=!0,this.isOriginal=!1,o.co2Change<0?(o.co2ChangeSumup=o.co2Change,o.costChangeSumup=o.costChange,o.costTotalChangeSumup=o.costTotalChange,o.addReduction(),t=this.calcMeasuresOne(-1)):(o.co2ChangeSumup=0,o.costChangeSumup=0,o.costTotalChangeSumup=0));for(a in this.measureList)(o=this.measureList[a]).selected=n[o.mesID],o.selected&&(this.isOriginal=!1);var c=[];for(s=0;s<t.length;s++)t[s].groupID!=e&&-1!=e||c.push(t[s]);return this.resMeasure=c,D6.debugMode&&(console.log("measure calculate in d6.js calcMeasures() --- "),console.log(c)),c},D6.calcMeasuresLifestyle=function(e){var t,s=new Array,i=D6.calcMeasures(e);for(t in i)1==i[t].lifestyle&&s.push(i[t]);return s},D6.calcMeasuresNotLifestyle=function(e){var t,s=[],i=D6.calcMeasures(e);for(t in i)1!=i[t].lifestyle&&s.push(i[t]);return s},D6.calcMeasuresOne=function(e){var t,s,i=this.sortTarget;for(s in t=new Array,new Array,new Array,this.consList)if((-1==e||this.consList[s].groupID==e)&&(this.consList[s].calcMeasureInit(),this.consList[s].calcMeasure(),1<=this.consList[s].subID)){var a=this.consListByName[this.consList[s].consName][0];for(var o in a.measures)a.measures[o].selected&&this.consList[s].measures[o].copy(a)}for(var n in s=0,this.measureList){var c=this.measureList[n];c.calcSave(),t[s]={},t[s][i]=c[i],t[s].mesID=c.mesID,t[s].groupID=c.groupID,t[s].lifestyle=c.lifestyle,s++}return this.ObjArraySort(t,i),t},D6.clearSelectedMeasures=function(e){this.isOriginal=!0,this.calcCons();for(var t=0;t<D6.measureList.length;t++)(this.measureList[t].groupID==e||e<0)&&(this.measureList[t].selected=!1);return this.calcMeasuresOne(e)},D6.calcMaxMeasuresList=function(e,t){var s,i,a,o,n,c=0,r=0,h=0,u=0,l=0;for(void 0===e&&(e=-1),(void 0===t||t<1)&&(t=15),this.clearSelectedMeasures(e),i=0;i<t;i++){for(c=-1,a=r=0;a<this.measureList.length;a++)((o=this.measureList[a]).groupID==e||e<0)&&(1==measureList[a].selected&&isFinite(o.co2Change)&&!isNaN(o.co2Change)||r>o.co2Change&&(r=o.co2Change,h=o.costChange,c=o.mesID,n=o));if(-1==c)break;u+=r,l+=h,this.measureAdd(c),n.addReduction(),this.calcMeasuresOne(-1)}return(s=calcMeasures(e)).sumCO2=u,s.sumCOST=l,s},(D6=D6||{}).inSet=function(e,t){var s=e.substr(0,4);"String"==D6.scenario.defInput[s].varType||"Boolean"==D6.scenario.defInput[s].varType?D6.doc.data[e]=t:(t=D6.toHalfWidth(t),D6.doc.data[e]=parseFloat(t)?parseFloat(t):0)},D6.measureAdd=function(e){return this.measureList[e].groupID,this.measureList[e].selected=!0,this.isOriginal=!1,""},D6.measureDelete=function(e){return this.measureList[e].selected=!1,this.measureList[e].groupID,""},(D6=D6||{}).toHalfWidth=function(e){return e?e.replace(/[！-～]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)}):e},D6.ObjArraySort=function(e,s,t){var i=1;t&&"desc"==t.toLowerCase()&&(i=-1),e.sort(function(e,t){return e[s]<t[s]?-1*i:e[s]==t[s]?0:1*i})},D6.scenario={defCons:[],defMeasures:[],defEquipment:[],defEquipmentSize:[],defInput:[],defSelectValue:[],defSelectData:[],defQuesOrder:[],getLogicList:function(){var e=new Array;return e.consTotal=D6.consTotal,e.consEnergy=D6.consEnergy,e.consSeason=D6.consSeason,e.consHWsum=D6.consHWsum,e.consHWshower=D6.consHWshower,e.consHWtub=D6.consHWtub,e.consHWdresser=D6.consHWdresser,e.consHWdishwash=D6.consHWdishwash,e.consHWtoilet=D6.consHWtoilet,e.consCOsum=D6.consCOsum,e.consACcool=D6.consACcool,e.consHTsum=D6.consHTsum,e.consHTcold=D6.consHTcold,e.consACheat=D6.consACheat,e.consAC=D6.consAC,e.consRFsum=D6.consRFsum,e.consRF=D6.consRF,e.consLIsum=D6.consLIsum,e.consLI=D6.consLI,e.consTVsum=D6.consTVsum,e.consTV=D6.consTV,e.consDRsum=D6.consDRsum,e.consCRsum=D6.consCRsum,e.consCR=D6.consCR,e.consCRtrip=D6.consCRtrip,e.consCKpot=D6.consCKpot,e.consCKcook=D6.consCKcook,e.consCKrice=D6.consCKrice,e.consCKsum=D6.consCKsum,e},setDefs:function(){var e=[],t=[];e.sel021=["select","hokkaido"],t.sel021=["-1","1"],e.sel022=["select","north","south"],t.sel022=["-1","1","2"],this.defCalcAverage=["i001","i005","i021"],this.measuresSortChange="i010",this.measuresSortTarget=["co2ChangeOriginal","co2ChangeOriginal","costTotalChangeOriginal","co2ChangeW1Original","co2ChangeW2Original"],this.defEasyQues=[{title:"easy input",cname:"easy01",ques:["i021","i001","i002","i003","i051","i061","i063","i064","i075","i101","i103","i105","i116","i201","i202","i204","i205","i263","i501","i601","i701","i010"]},{title:"Action Point",cname:"action01",ques:["i502","i501","i621","i601","i205","i041","i237","i263","i061","i003","i001","i105","i106","i116","i121","i421","i721","i821"]}],this.defQuesOrder=["i010","i021","i001","i002","i003","i051","i061","i063","i064","i075","i101","i103","i105","i116","i201","i202","i204","i205","i263","i501","i601","i701"],this.defMeasures=[],this.defInput=[],this.defSelectValue=e,this.defSelectData=t,this.defEquipment=[],this.defEquipmentSize=[],D6.area.setCalcBaseParams=function(){D6.area.setPersonArea(D6.doc.data.i001,D6.doc.data.i021,D6.doc.data.i023)},D6.area.getSeasonParamCommon=function(){return D6.area.getSeasonParam(D6.area.area)}}},D6.consEnergy=D6.object(D6.ConsBase),D6.consEnergy.init=function(){this.consName="consEnergy",this.consCode="",this.title="General Energy Setting",this.orgCopyNum=0,this.groupID="0",this.color="#ff0000",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="the use of energy of the whole house, monthly bills",this.partConsName=[]},D6.consEnergy.init(),D6.consEnergy.calc=function(){this.clear()},D6.consEnergy.calcMeasure=function(){},D6.consSeason=D6.object(D6.ConsBase),D6.consSeason.init=function(){this.titleList=["","winter","spring/fall","summer"],this.consName="consSeason",this.consCode="",this.title="",this.orgCopyNum=3,this.groupID="2",this.color="#ff0000",this.countCall="",this.residueCalc="sumup",this.sumConsName="",this.sumCons2Name="consTotal",this.inputDisp="consTotal",this.inputGuide="For monthly water and electricity charges per season. Please fill in the approximate value."},D6.consSeason.init(),D6.consSeason.calc=function(){this.clear()},D6.consSeason.calcMeasure=function(){},D6.consTotal=D6.object(D6.ConsBase),D6.consTotal.init=function(){this.consName="consTotal",this.consCode="TO",this.title="whole",this.orgCopyNum=0,this.groupID="9",this.color="#a9a9a9",this.countCall="",this.sumConsName="",this.sumCons2Name="",this.inputGuide="Basic information about the area and house",this.noPriceData={},this.ratioNightEcocute=.4,this.ratioNightHWElec=.6,this.solarSaleRatio=.6,this.generateEleUnit=1e3,this.reduceHEMSRatio=.1,this.standardSize=3.6,this.noConsData=!0,this.averagePriceElec,this.seasonConsPattern=[1.4,1,1.2]},D6.consTotal.init(),D6.consTotal.precalc=function(){this.clear(),this.person=this.input("i001",3),this.solarSet=this.input("i051",0),this.solarKw=this.input("i052",3.5*this.solarSet),this.solarYear=this.input("i053",0),this.priceEle=this.input("i061",D6.area.averageCostEnergy.electricity),this.priceEleSpring=this.input("i0912",-1),this.priceEleSummer=this.input("i0913",-1),this.priceEleWinter=this.input("i0911",-1),this.noPriceData.electricity=-1==this.input("i061",-1)&-1==this.priceEleSpring&-1==this.priceEleSummer&-1==this.priceEleWinter,this.priceEleSell=this.input("i062",0),this.priceGas=this.input("i063",D6.area.averageCostEnergy.gas),this.priceGasSpring=this.input("i0932",-1),this.priceGasSummer=this.input("i0933",-1),this.priceGasWinter=this.input("i0931",-1),this.noPriceData.gas=-1==this.input("i063",-1)&-1==this.priceGasSpring&-1==this.priceGasSummer&-1==this.priceGasWinter,this.houseType=this.input("i002",-1),this.houseSize=this.input("i003",1==this.person?60:80+10*this.person),this.heatEquip=this.input("i202",-1),this.priceKerosSpring=this.input("i0942",-1),this.priceKerosSummer=this.input("i0943",-1),this.priceKerosWinter=this.input("i0941",-1),this.noPriceData.kerosene=-1==this.priceKerosSpring&-1==this.priceKerosSummer&-1==this.priceKerosWinter,-1==this.priceKerosWinter&&(D6.area.averageCostEnergy.kerosene<1e3?this.priceKeros=this.input("i064",0):this.priceKeros=this.input("i064",D6.area.averageCostEnergy.kerosene/D6.area.seasonMonth.winter*12)),this.priceCar=this.input("i075",D6.area.averageCostEnergy.car),this.noPriceData.car=-1==this.input("i075",-1),this.equipHWType=this.input("i101",1),this.generateEleUnit=D6.area.unitPVElectricity,this.seasonPrice={electricity:[this.priceEleWinter,this.priceEleSpring,this.priceEleSummer],gas:[this.priceGasWinter,this.priceGasSpring,this.priceGasSummer],kerosene:[this.priceKeros,this.priceKerosSpring,this.priceKerosSummer],car:[-1,-1,-1]},this.monthlyPrice={electricity:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],gas:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],kerosene:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],car:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},D6.area.averageCostEnergy.kerosene<1e3&&this.input("i063",-1)<0&&this.input("i0931",-1)<0&&this.input("i0932",-1)<0&&this.input("i0933",-1)<0&&(this.keros2gas=D6.area.averageCostEnergy.kerosene/D6.Unit.price.kerosene*D6.Unit.calorie.kerosene/D6.Unit.calorie.gas*D6.Unit.price.gas,this.priceGasSpring+=this.keros2gas,this.priceGasWinter+=this.keros2gas)},D6.consTotal.calc=function(){var e,t,s=D6.area.getSeasonParamCommon();e=D6.calcMonthly(this.priceEle,this.seasonPrice.electricity,this.monthlyPrice.electricity,s.electricity,"electricity"),this.priceEle=e.ave,this.seasonPrice.electricity=e.season,this.monthlyPrice.electricity=e.monthly,this.noConsData=e.noConsData&&-1==this.input("i061",-1)&&this.noPriceData.gas&&this.noPriceData.car&&this.noPriceData.kerosene,5==this.equipHWType?(this.averagePriceElec=this.ratioNightHWElec*D6.Unit.price.nightelectricity+(1-this.ratioNightHWElec)*D6.Unit.price.electricity,this.allDenka=!0):6==this.equipHWType?(this.averagePriceElec=this.ratioNightEcocute*D6.Unit.price.nightelectricity+(1-this.ratioNightEcocute)*D6.Unit.price.electricity,this.allDenka=!0):(this.averagePriceElec=D6.Unit.price.electricity,this.allDenka=!1),t=this.allDenka?D6.Unit.price.nightelectricity:0;var i=this.generateEleUnit*this.solarKw/12;this.pvRestrict=1,2!=D6.area.electCompany&&3!=D6.area.electCompany&&5!=D6.area.electCompany||(this.pvRestrict=0);var a=D6.Unit.price.sellelectricity;1990<this.solarYear&&this.solarYear<=2010?a=48:2011==this.solarYear||2012==this.solarYear?a=42:2013==this.solarYear?a=38:2014==this.solarYear?a=37:2015==this.solarYear?a=1==this.pvRestrict?35:33:2016==this.solarYear?a=1==this.pvRestrict?33:31:2017<=this.solarYear&&this.solarYear<2020?a=1==this.pvRestrict?30:28:this.solarYear<2100&&(a=20),0<this.solarKw?(this.grossElectricity=(1-this.solarSaleRatio)*i+Math.max(0,this.priceEle-this.priceEleSell+this.solarSaleRatio*i*a-t)/this.averagePriceElec,this.electricity=this.grossElectricity-i):(this.electricity=(this.priceEle-t)/this.averagePriceElec,this.grossElectricity=this.electricity),e=D6.calcMonthly(this.priceGas,this.seasonPrice.gas,this.monthlyPrice.gas,s.gas,"gas"),this.priceGas=e.ave,this.seasonPrice.gas=e.season,this.monthlyPrice.gas=e.monthly,this.gas=(this.priceGas-D6.Unit.priceBase.gas)/D6.Unit.price.gas,e=D6.calcMonthly(this.priceKeros,this.seasonPrice.kerosene,this.monthlyPrice.kerosene,s.kerosene,"kerosene"),this.priceKeros=e.ave,this.seasonPrice.kerosene=e.season,this.monthlyPrice.kerosene=e.monthly,4==this.heatEquip&&this.priceKeros<1e3&&(this.priceKeros=2e3),this.kerosene=this.priceKeros/D6.Unit.price.kerosene,e=D6.calcMonthly(this.priceCar,this.seasonPrice.car,this.monthlyPrice.car,s.car,"car"),this.priceCar=e.ave,this.seasonPrice.car=e.season,this.monthlyPrice.car=e.monthly,this.car=this.priceCar/D6.Unit.price.car},D6.consTotal.calcMeasure=function(){var e,t=this.reduceHEMSRatio;if(1==this.pvRestrict?pvSellUnitPrice=30:pvSellUnitPrice=28,(e=this.measures.mTOsolar).copy(this),0==this.solarKw&&2!=this.houseType){var s=this.generateEleUnit*this.standardSize/12,i=s*this.solarSaleRatio*pvSellUnitPrice+s*(1-this.solarSaleRatio)*D6.Unit.price.electricity,a=this.electricity*t*D6.Unit.price.electricity;e.electricity=this.electricity*(1-t)-s,e.costUnique=this.cost-i-a,e.priceNew=this.standardSize*e.priceOrg,e.advice=D6.scenario.defMeasures.mTOsolar.advice+"<br>("+this.standardSize+"kW)"}(e=this.measures.mTOhems).copy(this),this.isSelected("mTOsolar")||(e.electricity=this.electricity*(1-this.reduceHEMSRatio)),(e=this.measures.mTOsolarSmall).copy(this);e.electricity-=.015*this.generateEleUnit/12},D6.consHWsum=D6.object(D6.ConsBase),D6.consHWsum.init=function(){this.consName="consHWsum",this.consCode="HW",this.title="hot water supply",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="how to use hot water supply in general",this.hwEnergy=0,this.waterTemp=18,this.hotWaterTemp=42,this.tabWaterLitter=200,this.showerWaterLitterUnit=10,this.reduceRateShowerHead=.3,this.showerWaterMinutes=5,this.otherWaterLitter=50,this.tankLossWatt=100,this.tabTemplatureDown=2,this.tabTemplatureInsulationDown=.5,this.performanceGas=.73,this.performanceEcojozu=.877,this.performanceElec=.8,this.performanceEcocute=3,this.performanceEnefarmEle=.289,this.performanceEnefarmHW=.33,this.performanceKeepWithTank=.6,this.reduceRateSaveMode=.2,this.reduceRateSolar=.4,this.reduceRateSolarSystem=.5,this.warmerElec_kWh_y=200,this.water_m3_d=.1,this.reduceRateKeepStop},D6.consHWsum.init(),D6.consHWsum.precalc=function(){this.clear(),this.person=this.input("i001",3),this.housetype=this.input("i002",1),this.prefecture=this.input("i021",13),this.solarHeater=this.input("i102",3),this.heatArea=D6.area.getHeatingLevel(this.prefecture),this.tabDayWeek=this.input("i103",1==this.heatArea||6==this.heatArea?2:6),this.tabDayWeekSummer=this.input("i104",2);var e=this.input2seasons("i105","i106",this.showerWaterMinutes*this.person);this.showerMinutes=e[0],this.showerMinutesSummer=e[1],this.showerHotTimeSpan=this.input("i112",10),this.savingShower=this.input("i116",-1),this.tabKeepHeatingTime=this.input("i108",1<this.person?3:0),this.keepMethod2=this.input("i111",5),this.keepMethod=this.input("i110",this.keepMethod2),this.tabInsulation=this.input("i117",-1),this.tabHeight=this.input("i107",8),this.equipType=this.input("i101",-1),this.priceGas=D6.consShow.TO.priceGas,this.priceKeros=D6.consShow.TO.priceKeros,this.dresserMonth=this.input("i114",4),this.dishWashMonth=this.input("i115",4),this.dishWashWater=this.input("i113",3),this.heaterPerformance=this.input("i121",2),this.cookingFreq=this.input("i802",6),this.keepSeason=this.input("i131",2)},D6.consHWsum.calc=function(){switch(this.equipType<=0&&(0==this.priceGas?3e3<this.priceKeros?this.equipType=3:this.equipType=5:this.equipType=1),1==this.equipType&&1==this.heaterPerformance&&this.equipType,5==this.equipType&&1==this.heaterPerformance&&this.equipType,2==this.equipType&&3==this.heaterPerformance&&this.equipType,this.waterTemp=D6.area.getWaterTemplature(),this.waterTemp=1==this.solarHeater?.4*this.hotWaterTemp+.6*this.waterTemp:2==this.solarHeater?.15*this.hotWaterTemp+.85*this.waterTemp:this.waterTemp,this.showerWaterLitter=((this.showerMinutes*(12-D6.area.seasonMonth.summer)+this.showerMinutesSummer*D6.area.seasonMonth.summer)/12*(1==this.savingShower?1-this.reduceRateShowerHead:1)+this.showerHotTimeSpan/60*5)*this.showerWaterLitterUnit,this.consHWtubLitter=this.tabWaterLitter*this.tabHeight/10*(this.tabDayWeek*(12-D6.area.seasonMonth.summer)+this.tabDayWeekSummer*D6.area.seasonMonth.summer)/12/7,this.allLitter=this.consHWtubLitter+this.showerWaterLitter+this.otherWaterLitter,this.heatTapEnergy=this.allLitter*(this.hotWaterTemp-this.waterTemp)*365/12,this.tabKeepEnergy=this.consHWtubLitter*this.tabKeepHeatingTime*365/12*(1==this.tabInsulation||2==this.tabInsulation?tabTemplatureInsulationDown:this.tabTemplatureDown)/(4==this.equipType||5==this.equipType?this.performanceKeepWithTank:1)*this.keepMethod/10,this.heatEnergy=this.heatTapEnergy+this.tabKeepEnergy,this.hwEnergy=this.heatEnergy,this.consHWtubRate=this.consHWtubLitter/this.allLitter+this.tabKeepEnergy/this.heatEnergy,this.consHWshowerRate=this.showerWaterLitter/this.allLitter*(this.heatTapEnergy/this.heatEnergy),this.consHWdresserRate=this.otherWaterLitter/2/this.allLitter*(this.heatTapEnergy/this.heatEnergy)*this.dresserMonth/6,this.consHWdishwashRate=this.otherWaterLitter/2/this.allLitter*(this.heatTapEnergy/this.heatEnergy)*(99==this.dishWashMonth?1:this.dishWashMonth/6)*(4-this.dishWashWater)/2*this.cookingFreq/6,this.tanklossEnergy=this.tankLossWatt/1e3*D6.Unit.calorie.electricity*365/12,this.equipType){case 1:this.mainSource="gas",this[this.mainSource]=this.heatEnergy/this.performanceGas/D6.Unit.calorie[this.mainSource];break;case 2:this.mainSource="gas",this[this.mainSource]=this.heatEnergy/this.performanceEcojozu/D6.Unit.calorie[this.mainSource];break;case 3:this.mainSource="kerosene",this[this.mainSource]=this.heatEnergy/this.performanceGas/D6.Unit.calorie[this.mainSource];break;case 4:this.mainSource="kerosene",this[this.mainSource]=this.heatEnergy/this.performanceEcojozu/D6.Unit.calorie[this.mainSource];break;case 5:this.mainSource="electricity",this[this.mainSource]=(this.heatEnergy+this.tanklossEnergy)/this.performanceElec/D6.Unit.calorie[this.mainSource];break;case 6:this.mainSource="electricity",this[this.mainSource]=(this.heatEnergy+this.tanklossEnergy)/this.performanceEcocute/D6.Unit.calorie[this.mainSource];break;case 7:case 8:default:this.mainSource="gas",this.gas=this.heatEnergy/this.performanceEcojozu/D6.Unit.calorie.gas}this.electricity+=this.warmerElec_kWh_y/12*(4-this.keepSeason)/3,this.water+=this.water_m3_d*this.person*30,this.reduceRateShowerTime=1/(this.showerMinutes/this.person-1)*this.consHWshowerRate,this.reduceRateTabKeep=this.tabKeepEnergy/(this.heatEnergy*this.consHWtubLitter/this.allLitter),this.reduceRateInsulation=1==this.tabInsulation||2==this.tabInsulation?0:this.reduceRateTabKeep*(this.tabTemplatureDown-this.tabTemplatureInsulationDown)/this.tabTemplatureDown;var e=this.tabDayWeekSummer*D6.area.seasonMonth.summer,t=this.tabDayWeek*(12-D6.area.seasonMonth.summer);this.reduceRateStopTabSummer=e/(e+t)},D6.consHWsum.calcMeasure=function(){var e=!1;(this.isSelected("mHWecocute")||this.isSelected("mHWecofeel")||this.isSelected("mHWenefarm"))&&(e=!0);var t=this.hwEnergy*this.co2/this.co2Original;if((-1==this.equipType||1==this.equipType||3==this.equipType||5==this.equipType)&&!e&&(1==this.housetype&&(this.measures.mHWecocute.clear(),this.measures.mHWecocute.nightelectricity=(t+this.tanklossEnergy)/this.performanceEcocute/D6.Unit.calorie.nightelectricity),3==this.equipType&&(this.measures.mHWecofeel.clear(),this.measures.mHWecofeel.kerosene=t/this.performanceEcojozu/D6.Unit.calorie.kerosene),this.measures.mHWecojoze.clear(),this.measures.mHWecojoze.gas=t/this.performanceEcojozu/D6.Unit.calorie.gas,1==this.housetype)){this.measures.mHWenefarm.clear();var s=t-5e5/12;this.measures.mHWenefarm.gas=(s/this.performanceEnefarmHW+5e5/12/this.performanceEcojozu)/D6.Unit.calorie.gas,this.measures.mHWenefarm.electricity=-s/this.performanceEnefarmHW*this.performanceEnefarmEle/D6.Unit.calorie.electricity}6!=this.equipType&&5!=this.equipType||this.measures.mHWsaveMode.calcReduceRate(this.reduceRateSaveMode);var i=!1;(this.isSelected("mHWecocute")||this.isSelected("mHWenefarm")||this.isSelected("mHWsolarSystem")||this.isSelected("mHWsolarHeater"))&&(i=!0),5==this.equipType||6==this.equipType||i||1!=this.housetype||(this.measures.mHWsolarHeater.calcReduceRate(this.reduceRateSolar),this.measures.mHWsolarSystem.calcReduceRate(this.reduceRateSolarSystem))},D6.consHWsum.calcAdjustStrategy=function(e){this.heatEnergy*=e[this.mainSource],this.tanklossEnergy*=e[this.mainSource],this.hwEnergy*=e[this.mainSource]},D6.consHWshower=D6.object(D6.ConsBase),D6.consHWshower.init=function(){this.consName="consHWshower",this.consCode="HW",this.title="shower",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consHWsum",this.sumCons2Name="",this.inputGuide="how to use shower"},D6.consHWshower.init(),D6.consHWshower.calc=function(){this.copy(this.sumCons),this.multiply(this.sumCons.consHWshowerRate)},D6.consHWshower.calcMeasure=function(){1!=this.sumCons.savingShower&&this.measures.mHWshowerHead.calcReduceRate(this.sumCons.reduceRateShowerHead),5<=this.sumCons.showerMinutes/this.sumCons.person&&!this.isSelected("mHWshowerTime30")&&this.measures.mHWshowerTime.calcReduceRate(this.sumCons.reduceRateShowerTime),this.measures.mHWshowerTime30.calcReduceRate(.3)},D6.consHWtub=D6.object(D6.ConsBase),D6.consHWtub.init=function(){this.autoKeepRate=.5,this.consName="consHWtub",this.consCode="HW",this.title="Bathtub",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consHWsum",this.sumCons2Name="",this.inputGuide="how to use hot water in bath tub"},D6.consHWtub.init(),D6.consHWtub.calc=function(){this.copy(this.sumCons),this.multiply(this.sumCons.consHWtubRate)},D6.consHWtub.calcMeasure=function(){this.measures.mHWinsulation.calcReduceRate(this.sumCons.reduceRateInsulation),this.measures.mHWkeep.calcReduceRate(this.sumCons.reduceRateTabKeep),5<this.sumCons.keepMethod&&this.measures.mHWstopAutoKeep.calcReduceRate(this.sumCons.reduceRateTabKeep*this.autoKeepRate),this.measures.mHWonlyShower.calcReduceRate(this.sumCons.reduceRateStopTabSummer)},D6.consHWdresser=D6.object(D6.ConsBase),D6.consHWdresser.init=function(){this.consName="consHWdresser",this.consCode="HW",this.title="basin",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consHWsum",this.sumCons2Name="",this.inputGuide="How to wash hot water in the basin"},D6.consHWdresser.init(),D6.consHWdresser.calc=function(){this.copy(this.sumCons),this.multiply(this.sumCons.consHWdresserRate)},D6.consHWdresser.calcMeasure=function(){},D6.consHWdishwash=D6.object(D6.ConsBase),D6.consHWdishwash.init=function(){this.reduceRateWashTank=.3,this.reduceRateWashNotSummer=.5,this.reduceRateDishWasher=.2,this.consName="consHWdishwash",this.consCode="HW",this.title="Dish Wash",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consHWsum",this.sumCons2Name="",this.inputGuide="How to use the dishwasher"},D6.consHWdishwash.init(),D6.consHWdishwash.calc=function(){this.sumCons.value;this.copy(this.sumCons),this.multiply(this.sumCons.consHWdishwashRate)},D6.consHWdishwash.calcMeasure=function(){1!=this.sumCons.dishWashWater&&this.measures.mHWdishTank.calcReduceRate(this.reduceRateWashTank),1!=this.sumCons.dishWashWater&&this.measures.mHWdishWater.calcReduceRate(this.reduceRateWashNotSummer)},D6.consHWtoilet=D6.object(D6.ConsBase),D6.consHWtoilet.init=function(){this.warmerElec_kWh_y=200,this.resudeRateGoodSheat=.5,this.resudeRateTemplature=.2,this.resudeRateCover=.1,this.water_m3_d=.1,this.consName="consHWtoilet",this.consCode="HW",this.title="toilet",this.orgCopyNum=0,this.groupID="1",this.color="#ffb700",this.countCall="",this.sumConsName="consHWsum",this.sumCons2Name="",this.inputGuide="How to use toilet water and heat insulation"},D6.consHWtoilet.init(),D6.consHWtoilet.precalc=function(){this.clear(),this.person=this.input("i001",3),this.keepSeason=this.input("i131",2),this.keepTemp=this.input("i132",2),this.savingToilet=this.input("i133",2),this.coverToilet=this.input("i134",1)},D6.consHWtoilet.calc=function(){this.electricity=this.warmerElec_kWh_y/12*(4-this.keepSeason)/3*(1==this.keepTemp?1.1:3==this.keepTemp?.9:1)*(1==this.savingToilet?.5:1)*(2==this.coverToilet?1.1:1),this.water=this.water_m3_d*this.person*30},D6.consHWtoilet.calcMeasure=function(){this.measures.mHWreplaceToilet5.copy(this),this.measures.mHWreplaceToilet5.water=this.water_m3_d*this.person*30/2,1==this.savingToilet&&4==this.keepSeason||this.measures.mHWreplaceToilet.calcReduceRate(this.resudeRateGoodSheat),this.isSelected("mHWreplaceToilet")||1==this.savingToilet||(1==this.keepTemp?this.measures.mHWtemplatureToilet.calcReduceRate(this.resudeRateTemplature):2==this.keepTemp&&this.measures.mHWtemplatureToilet.calcReduceRate(this.resudeRateTemplature/2)),this.isSelected("mHWreplaceToilet")||1==this.savingToilet||1==this.coverToilet||this.measures.mHWcoverTilet.calcReduceRate(this.resudeRateCover)},D6.consCOsum=D6.object(D6.ConsBase),D6.consCOsum.init=function(){this.coolLoadUnit_Wood=220,this.coolLoadUnit_Steel=145,this.apf=4,this.reduceRateSunCut=.1,this.consName="consCOsum",this.consCode="CO",this.title="cooling",this.orgCopyNum=0,this.groupID="2",this.color="#0000ff",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="how to use air cooling in the whole house"},D6.consCOsum.init(),D6.consCOsum.precalc=function(){this.clear(),this.person=this.input("i001",3),this.houseSize=this.input("i003",1==this.person?60:80+10*this.person),this.houseType=this.input("i002",1),this.coolArea=this.input("i201",.5),this.coolTime=this.input("i261",4),this.coolTemp=this.input("i263",27),this.coolMonth=this.input("i264",D6.area.seasonMonth.summer)},D6.consCOsum.calc=function(){var e;e=this.houseSize*this.coolArea,.05<this.coolArea&&(e=Math.max(e,13));var t=this.calcCoolLoad(e,this.coolTime,this.coolMonth,this.coolTemp);t*=this.coolMonth/12,this.electricity=t/this.apf/D6.Unit.calorie.electricity},D6.consCOsum.calcMeasure=function(){this.measures.mCOsunCut.calcReduceRate(this.reduceRateSunCut)},D6.consCOsum.calcCoolLoad=function(e,t,s,i){var a=0;a=1==this.houseType?this.coolLoadUnit_Wood:this.coolLoadUnit_Steel,t=this.coolTime;var o,n=D6.area.getCoolFactor(s,t);return o=(27-this.coolTemp)/10+1,a*n[0]*e*t*30*o},D6.consACcool=D6.object(D6.consCOsum),D6.consACcool.init=function(){this.consName="consACcool",this.consCode="",this.title="room air conditioning",this.orgCopyNum=1,this.addable="room air conditioning",this.groupID="2",this.color="#0000ff",this.countCall="th room",this.sumConsName="consCOsum",this.sumCons2Name="consAC",this.inputGuide="how to use air conditioning for each room"},D6.consACcool.init(),D6.consACcool.precalc=function(){this.clear(),this.houseSize=1,this.ac=D6.consListByName.consAC[this.subID],this.coolArea=this.input("i212"+this.subID,12),this.coolTime=this.input("i271"+this.subID,this.sumCons.coolTime),this.coolTemp=this.input("i273"+this.subID,this.sumCons.coolTemp),this.coolMonth=this.input("i274"+this.subID,this.sumCons.coolMonth)},D6.consACcool.calc=function(){var e=this.calcCoolLoad(this.coolArea,this.coolTime,this.coolTemp,this.coolMonth);e*=D6.area.seasonMonth.summer/12,this.electricity=e/this.ac.apf/D6.Unit.calorie.electricity},D6.consACcool.calc2nd=function(){if(0==this.subID){this.electricity=this.sumCons.electricity;for(var e=D6.consListByName[this.consName],t=1;t<e.length;t++)this.electricity-=e[t].electricity}},D6.consACcool.calcMeasure=function(){0<this.subID||this.electriity==this.sumCons.electricity||(this.coolTemp<28&&20<this.coolTemp?this.measures.mCOtemplature.calcReduceRate((28-this.coolTemp)/10):this.measures.mCOtemplature.calcReduceRate(0))},D6.consHTsum=D6.object(D6.ConsBase),D6.consHTsum.init=function(){this.consName="consHTsum",this.consCode="HT",this.title="heating",this.orgCopyNum=0,this.groupID="2",this.color="#ff0000",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="how to use the whole house heating",this.heatMcal,this.heatACCalcMcal,this.heatLoadUnit_Wood=225.5,this.heatLoadUnit_Steel=148.625,this.apf=3,this.apfMax=4.5,this.reduceRateInsulation=.082,this.reduceRateDouble=.124,this.reduceRateUchimado=.14,this.reduceRateLowe=.16,this.reduceRateFilterCool=.05,this.reduceRateFilter=.12,this.reduceRateDanran=.303},D6.consHTsum.init(),D6.consHTsum.precalc=function(){this.clear(),this.prefecture=this.input("i021",13),this.heatArea=D6.area.getHeatingLevel(this.prefecture),this.person=this.input("i001",3),this.houseType=this.input("i002",1),this.houseSize=D6.consShow.TO.houseSize,this.heatSpace=this.input("i201",this.heatArea<=2?.6:3==this.heatArea?.25:.2),this.heatEquip=this.input("i202",-1),this.heatTime=this.input("i204",1==this.heatArea?24:2==this.heatArea?10:(this.heatArea,6)),this.heatMonth=this.input("i206",D6.area.seasonMonth.winter),this.heatTemp=this.input("i205",21),this.priceEleSpring=this.input("i0912",-1),this.priceEleWinter=this.input("i0911",-1),this.priceGasSpring=this.input("i0922",-1),this.priceGasWinter=this.input("i0921",-1),this.consKeros=this.input("i064",-1),this.hotwaterEquipType=this.input("i101",-1),this.performanceWindow=this.input("i041",-1),this.performanceWall=this.input("i042",-1),this.reformWindow=this.input("i043",-1),this.reformfloor=this.input("i044",-1)},D6.consHTsum.calc=function(){var e=this.houseSize*this.heatSpace;.05<this.heatSpace&&(e=Math.max(e,13));var t=this.calcHeatLoad(e,this.heatTime,this.heatMonth,this.heatTemp);t*=this.heatMonth/12,this.endEnergy=t,this.heatEquip<=0&&(0<this.consKeros||1e3<D6.area.averageCostEnergy.kerosene?this.heatEquip=4:this.priceGasWinter<0||4e3<this.priceGasWinter?this.heatEquip=3:this.heatEquip=1);var s=0,i=1==this.heatEquip?this.apf:1;if((1==this.heatEquip||2==this.heatEquip)&&0<this.priceEleWinter){var a=.7*this.priceEleWinter/D6.Unit.price.electricity*this.heatMonth/12;if(t/i/D6.Unit.calorie.electricity>a)t-=s=t-a*i*D6.Unit.calorie.electricity}1==this.heatEquip||2==this.heatEquip?this.mainSource="electricity":3==this.heatEquip?this.mainSource="gas":4==this.heatEquip?this.mainSource="kerosene":0<this.priceHotWater?this.mainSource="hotwater":this.mainSource=this.sumCons.mainSource,this.calcACkwh=t/this.apf/D6.Unit.calorie.electricity,"electricity"==this.mainSource&&2!=this.heatEquip?this[this.mainSource]=this.calcACkwh:this[this.mainSource]=t/D6.Unit.calorie[this.mainSource];var o=-1;o=Math.max(0,this.priceEleWinter-this.priceEleSpring)/D6.Unit.price.electricity,-1!=this.priceEleSpring&&-1!=this.priceEleWinter?5!=this.hotwaterEquipType&&6!=this.hotwaterEquipType&&(this.electricity=(2*this.electricity+o)/3):this.electricity=(4*this.electricity+o)/5,o=Math.max(0,this.priceGasWinter-this.priceGasSpring)/D6.Unit.price.gas;var n;-1!=this.priceGasSpring&&-1!=this.priceGasWinter?3<=this.hotwaterEquipType&&this.hotwaterEquipType<=6?this.gas=(3*this.gas+o)/4:this.gas=(2*this.gas+o)/3:this.gas=(4*this.gas+o)/5,n=Math.max(0,this.gas-o);var c=0;-1!=this.consKeros&&3!=this.hotwaterEquipType&&4!=this.hotwaterEquipType&&(o=this.consKeros/D6.Unit.price.kerosene,c=Math.max(0,this.kerosene-o),this.kerosene=o),0<s&&(D6.Unit.areaHeating<=4&&0<this.priceKeros?this.kerosene+=s*D6.Unit.calorie.electricity/D6.Unit.calorie.kerosene:this.gas+=s*D6.Unit.calorie.electricity/D6.Unit.calorie.gas),0<n&&(0<this.priceKeros?this.kerosene=Math.min(n*D6.Unit.calorie.gas/D6.Unit.calorie.kerosene,this.consKeros/D6.Unit.price.kerosene):this.electricity+=n*D6.Unit.calorie.gas/D6.Unit.calorie.electricity),0<c&&(this.electricity+=c*D6.Unit.calorie.kerosene/D6.Unit.calorie.electricity),this.calcACkwh=t/this.apf/D6.Unit.calorie.electricity,"electricity"==this.mainSource&&2!=this.heatEquip?this[this.mainSource]=this.calcACkwh:this[this.mainSource]=t/D6.Unit.calorie[this.mainSource]},D6.consHTsum.calc2nd=function(){var e,t,s=D6.consShow.HW,i=D6.consShow.TO,a=D6.consShow.CK;if(e=Math.max(0,i.kerosene-s.kerosene),t=Math.max(0,i.gas-s.gas-a.gas),4==this.heatEquip&&this.kerosene>e&&-1!=this.consKeros&&(this.kerosene-e>t*D6.Unit.calorie.gas/D6.Unit.calorie.kerosene?(this.electricity+=(this.kerosene-e)*D6.Unit.calorie.kerosene/D6.Unit.calorie.electricity,this.electricity=Math.min(this.electricity,D6.consShow.TO.electricity*this.heatMonth/12*.7),this.kerosene=e,this.gas=t):(this.gas+=(this.kerosene-e)*D6.Unit.calorie.kerosene/D6.Unit.calorie.gas,this.kerosene=e)),0<e)if(-1==this.consKeros){D6.consShow.TO.kerosene=s.kerosene+this.kerosene;var o=D6.area.getSeasonParamCommon();ret=D6.calcMonthly(D6.consShow.TO.kerosene*D6.Unit.price.kerosene,[-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],o.kerosene,"kerosene"),D6.consShow.TO.priceKeros=ret.ave,D6.consShow.TO.seasonPrice.kerosene=ret.season,D6.consShow.TO.monthlyPrice.kerosene=ret.monthly}else this.kerosene=e;3==this.heatEquip&&this.gas>t&&(this.electricity+=(this.gas-t)*D6.Unit.calorie.gas/D6.Unit.calorie.electricity,this.gas=t),this.electricity+=D6.consListByName.consHWtoilet[0].electricity},D6.consHTsum.calcHeatLoad=function(e,t,s,i){var a=this.heatLoadUnit_Wood;1==this.heatArea?a*=.3:this.heatArea<=2&&(a*=.6),200<=this.performanceWall?a=.2*this.heatLoadUnit_Wood:100<=this.performanceWall?a=.4*this.heatLoadUnit_Wood:50<=this.performanceWall?a=.7*this.heatLoadUnit_Wood:30<=this.performanceWall&&(a=this.heatLoadUnit_Wood),2==this.houseType&&(a*=this.heatLoadUnit_Steel/this.heatLoadUnit_Wood);var o=D6.area.getHeatFactor(s,t),n=Math.min(t,.3*(t-8)+8)/t,c=(i-20)/10+1;return a*o[1]*e*t*n*30*c},D6.consHTsum.calcHeatLoadbyPrice=function(){return 0},D6.consHTsum.calcAdjustStrategy=function(e){this.calcACkwh*=e[this.mainSource],this.endEnergy*=e[this.mainSource]},D6.consHTsum.calcMeasure=function(){this.isSelected("mHTuchimadoAll")||this.isSelected("mHTloweAll")||2==this.houseType||this.measures.mHTdoubleGlassAll.calcReduceRate(this.reduceRateDouble),this.isSelected("mHTloweAll")||this.measures.mHTuchimadoAll.calcReduceRate(this.reduceRateUchimado),2!=this.houseType&&this.measures.mHTloweAll.calcReduceRate(this.reduceRateLowe)},D6.consHTcold=D6.object(D6.ConsBase),D6.consHTcold.init=function(){this.consName="consHTcold",this.consCode="",this.title="In the cold climate area",this.orgCopyNum=0,this.groupID="2",this.color="#ff0000",this.countCall="",this.sumConsName="consHTsum",this.sumCons2Name="",this.inputGuide="How to use heating in cold climate area"},D6.consHTcold.init(),D6.consHTcold.calc=function(){this.clear()},D6.consHTcold.calcMeasure=function(){},D6.consACheat=D6.object(D6.consHTsum),D6.consACheat.init=function(){this.consName="consACheat",this.consCode="",this.title="room heating",this.orgCopyNum=1,this.addable="room air conditioning",this.sumConsName="consHTsum",this.sumCons2Name="consAC",this.groupID="2",this.color="#ff0000",this.countCall="th room",this.inputGuide="how to use each room heating"},D6.consACheat.init(),D6.consACheat.precalc=function(){this.clear(),this.houseSize=1,this.ac=D6.consListByName.consAC[this.subID],this.consHeat=Object.getPrototypeOf(this),this.heatSpace=this.input("i212"+this.subID,13),this.heatEquip=this.input("i231"+this.subID,this.consHeat.heatEquip),this.heatTime=this.input("i233"+this.subID,this.consHeat.heatTime),this.heatTemp=this.input("i234"+this.subID,this.consHeat.heatTemp),this.heatMonth=this.input("i235"+this.subID,this.consHeat.heatMonth),this.windowArea=this.input("i213"+this.subID,-1),this.windowPerf=this.input("i214"+this.subID,-1)},D6.consACheat.calc=function(){var e=this.calcHeatLoad(this.heatSpace,this.heatTime,this.heatMonth,this.heatTemp);e*=this.heatMonth/12,this.endEnergy=e,this.heatEquip<=0&&(this.heatEquip=this.consHeat.heatEquip),1==this.heatEquip||2==this.heatEquip?this.mainSource="electricity":3==this.heatEquip?this.mainSource="gas":4==this.heatEquip?this.mainSource="kerosene":this.mainSource=this.sumCons.mainSource,this.calcACkwh=e/this.ac.apf/D6.Unit.calorie.electricity,"electricity"==this.mainSource&&2!=this.heatEquip?this[this.mainSource]=this.calcACkwh:this[this.mainSource]=e/D6.Unit.calorie[this.mainSource]},D6.consACheat.calc2nd=function(){if(0==this.subID){this.copy(this.sumCons);for(var e=D6.consListByName[this.consName],t=1;t<e.length;t++)this.sub(e[t])}},D6.consACheat.calcMeasure=function(){1==this.heatEquip?(this.measures.mACfilter.copy(this),this.measures.mACfilter.electricity=this.electricity*(1-this.reduceRateFilter)-D6.consShow.CO.electricity*this.reduceRateFilterCool):(this.measures.mACchangeHeat.clear(),this.measures.mACchangeHeat.electricity=this.endEnergy/this.ac.nowEquip.pf2/D6.Unit.calorie.electricity,this.measures.mACfilter.copy(this),this.measures.mACfilter.electricity=this.electricity-D6.consShow.CO.electricity*this.reduceRateFilterCool),2<=this.person&&.3<this.heatSpace&&40<this.houseSize&&this.measures.mHTdanran.calcReduceRate(this.reduceRateDanran),this.sumCons.isSelected("mHTdoubleAll")||this.sumCons.isSelected("mHTuchimadoAll")||this.sumCons.isSelected("mHTloweAll")||this.sumCons.isSelected("mHTuchimado")||this.sumCons.isSelected("mHTlowe")||this.measures.mHTdouble.calcReduceRate(this.reduceRateDouble),this.sumCons.isSelected("mHTuchimadoAll")||this.sumCons.isSelected("mHTloweAll")||this.sumCons.isSelected("mHTlowe")||this.measures.mHTuchimado.calcReduceRate(this.reduceRateUchimado),this.sumCons.isSelected("mHTloweAll")||this.measures.mHTlowe.calcReduceRate(this.reduceRateLowe),this.measures.mHTwindowSheet.calcReduceRate(this.reduceRateInsulation),21<=this.heatTemp&&this.measures.mHTtemplature.calcReduceRate((this.heatTemp-20)/10),2<this.heatTime&&this.measures.mHTtime.calcReduceRate(1/(this.heatTime-1)),this.measures.mHTuchimado.calcReduceRate(.15),this.measures.mHTceiling.calcReduceRate(.1)},D6.consAC=D6.object(D6.ConsBase),D6.consAC.init=function(){this.consName="consAC",this.consCode="",this.title="room air conditioning",this.orgCopyNum=1,this.groupID="2",this.color="#ff0000",this.countCall="th room",this.sumConsName="",this.sumCons2Name="",this.inputDisp="consACcool",this.inputGuide="",this.consAddSet=["consACcool","consACheat"]},D6.consAC.init(),D6.consAC.precalc=function(){this.clear(),this.acYear=this.input("i215"+this.subID,6),this.acPerf=this.input("i216"+this.subID,2),this.acFilter=this.input("i217"+this.subID,-1),this.roomSize=this.input("i212"+this.subID,12);var e=new Date;this.nowEquip=this.equip(e.getFullYear()-this.acYear,this.roomSize<16?2.8:4),this.newEquip=this.equip(e.getFullYear(),this.roomSize<16?2.8:4),this.apf=.7*this.nowEquip.pf2,this.apfMax=.7*this.newEquip.pf1,D6.debugMode&&(console.assert(6.5==this.equip(2015,2.8).pf1,"2015 2.8kW"),console.assert(7==this.equip(2030,4.5).pf1,"2030 4.5kW"),console.assert(2e5==this.equip(e.getFullYear(),4.5).pr1,"now 4.5kW price"),console.assert(6<this.equip(e.getFullYear(),4.5).pf1,"now 4.5kW price"))},D6.consAC.calc=function(){},D6.consAC.calc2nd=function(){this.acHeat=D6.consListByName.consACheat[this.subID],this.acCool=D6.consListByName.consACcool[this.subID],this.copy(this.acHeat),this.add(this.acCool)},D6.consAC.equip=function(e,t){return this.getEquipParameters(e,t,[2.8,4.5,100],{2.8:{1900:{pf1:3,pf2:2,pr1:15e4,pr2:12e4},1995:{pf1:3,pf2:2,pr1:15e4,pr2:12e4},2005:{pf1:5,pf2:3.5,pr1:15e4,pr2:12e4},2015:{pf1:6.5,pf2:5,pr1:15e4,pr2:12e4},2030:{pf1:7,pf2:6,pr1:15e4,pr2:12e4}},4.5:{1900:{pf1:3,pf2:2,pr1:2e5,pr2:16e4},1995:{pf1:3,pf2:2,pr1:2e5,pr2:16e4},2005:{pf1:4,pf2:2.5,pr1:2e5,pr2:16e4},2015:{pf1:6,pf2:4,pr1:2e5,pr2:16e4},2030:{pf1:7,pf2:6,pr1:2e5,pr2:16e4}},100:{1900:{pf1:3,pf2:2,pr1:24e4,pr2:22e4},1995:{pf1:3,pf2:2,pr1:24e4,pr2:22e4},2005:{pf1:3.5,pf2:2.5,pr1:24e4,pr2:22e4},2015:{pf1:4.5,pf2:3.5,pr1:24e4,pr2:22e4},2030:{pf1:6,pf2:5,pr1:24e4,pr2:22e4}}})},D6.consAC.calcMeasure=function(){var e;if(e=this.measures.mACreplace,!this.isSelected("mACreplaceHeat")&&(e.copy(this),1==this.acHeat.heatEquip?(e.electricity=this.electricity*this.apf/this.apfMax,e.consACheat=D6.object(D6.Energy),e.consACheat.copy(this.acHeat),e.consACheat.electricity=this.acHeat.electricity*this.apf/this.apfMax):e.electricity-=this.acCool.electricity*(1-this.apf/this.apfMax),e.consACcool=D6.object(D6.Energy),e.consACcool.copy(this.acCool),e.consACcool.electricity=this.acCool.electricity*this.apf/this.apfMax,.3<this.acHeat.heatArea&&60<this.acHeat.houseSize)){var t=Math.round(Math.max(this.acHeat.houseSize*this.acHeat.heatArea,25)/25);e.priceNew=t*e.def.price}e=this.measures.mACreplaceHeat,1==!this.acHeat.heatEquip&&(e.clear(),e.consACheat=D6.object(D6.Energy),e.consACheat.copy(this.acHeat),e.consACheat.electricity=this.acHeat.endEnergy/this.apfMax/D6.Unit.calorie.electricity,e.consACcool=D6.object(D6.Energy),e.consACcool.copy(this.acCool),e.consACcool.electricity=this.acCool.electricity*this.acHeat.apf/this.apfMax,e.electricity=e.consACheat.electricity+e.consACcool.electricity,.3<this.heatArea&&60<this.houseSize&&(e.priceNew=Math.round(Math.max(this.houseSize*this.heatArea,25)/25)*this.nowEquip.pr1))},D6.consRFsum=D6.object(D6.ConsBase),D6.consRFsum.init=function(){this.consName="consRFsum",this.consCode="RF",this.title="refrigerator",this.orgCopyNum=0,this.sumConsName="consTotal",this.sumCons2Name="",this.groupID="3",this.color="#a0ffa0",this.residueCalc="no",this.inputGuide="usage of refrigerator"},D6.consRFsum.init(),D6.consRFsum.calc=function(){this.clear(),this.count=this.input("i701",1)},D6.consRFsum.calcMeasure=function(){},D6.consRFsum.equip=function(e,t){return this.getEquipParameters(e,t,[100,200,300,400,500,1100],{100:{1900:{pf1:300,pf2:400,pr1:5e4,pr2:4e4},2005:{pf1:300,pf2:400,pr1:5e4,pr2:4e4},2015:{pf1:250,pf2:350,pr1:5e4,pr2:4e4},2030:{pf1:250,pf2:350,pr1:5e4,pr2:4e4}},200:{1900:{pf1:350,pf2:450,pr1:9e4,pr2:7e4},2005:{pf1:350,pf2:450,pr1:9e4,pr2:7e4},2015:{pf1:350,pf2:450,pr1:9e4,pr2:7e4},2030:{pf1:350,pf2:450,pr1:9e4,pr2:7e4}},300:{1900:{pf1:500,pf2:750,pr1:12e4,pr2:1e5},2005:{pf1:450,pf2:550,pr1:12e4,pr2:1e5},2015:{pf1:350,pf2:450,pr1:9e4,pr2:7e4},2030:{pf1:350,pf2:450,pr1:9e4,pr2:7e4}},400:{1900:{pf1:700,pf2:950,pr1:14e4,pr2:12e4},1995:{pf1:650,pf2:900,pr1:14e4,pr2:12e4},2015:{pf1:300,pf2:550,pr1:12e4,pr2:1e5},2030:{pf1:300,pf2:400,pr1:12e4,pr2:1e5}},500:{1900:{pf1:900,pf2:1300,pr1:2e5,pr2:18e4},1995:{pf1:900,pf2:1200,pr1:2e5,pr2:18e4},2015:{pf1:300,pf2:550,pr1:16e4,pr2:14e4},2030:{pf1:300,pf2:400,pr1:16e4,pr2:14e4}},1100:{1900:{pf1:1e3,pf2:1500,pr1:22e4,pr2:2e5},1995:{pf1:900,pf2:1400,pr1:22e4,pr2:2e5},2015:{pf1:400,pf2:750,pr1:2e5,pr2:18e4},2030:{pf1:400,pf2:500,pr1:2e5,pr2:18e4}}})},D6.consRF=D6.object(D6.consRFsum),D6.consRF.init=function(){this.consYear=650,this.consYearAdvanced=300,this.reduceRateWall=.1,this.reduceRateTemplature=.12,this.consName="consRF",this.consCode="",this.title="refrigerator",this.orgCopyNum=1,this.addable="refrigerator",this.groupID="3",this.color="#a0ffa0",this.countCall="th",this.sumConsName="consRFsum",this.sumCons2Name="",this.inputGuide="How to use each refrigerator"},D6.consRF.init(),D6.consRF.precalc=function(){this.clear(),this.year=this.input("i711"+this.subID,8),this.type=this.input("i712"+this.subID,1),this.size=this.input("i713"+this.subID,350),this.templature=this.input("i714"+this.subID,4),this.full=this.input("i715"+this.subID,4),this.space=this.input("i716"+this.subID,3),this.performance=this.input("i721",2);var e=new Date;this.nowEquip=this.equip(e.getFullYear()-this.year,this.size),this.newEquip=this.equip(e.getFullYear(),this.size)},D6.consRF.calc=function(){this.consYear=this.nowEquip.pf2*(2==this.type?2:1),this.consYearAdvanced=this.newEquip.pf1*(2==this.type?2:1),this.reduceRateChange=this.consYearAdvanced/this.consYear,0!=this.subID?0<this.subID&&this.input("i711"+this.subID,-1)<0&&this.input("i713"+this.subID,-1)<0||(this.electricity=this.consYear/12,this.electricity=this.electricity*(3==this.full?1.1:1==this.full?.9:1),this.electricity=this.electricity*(1==this.space?.95:2==this.space?1.05:1),this.electricity=this.electricity*(1==this.templature?1.1:3==this.templature?.95:1),this.electricity=this.electricity*(1==this.performance?.8:3==this.performance?1.2:1)):this.input("i7111",-1)<0&&this.input("i7131",-1)<0?this.electricity=this.consYear*this.count/12:this.electricity=0},D6.consRF.calcMeasure=function(){this.measures.mRFreplace.calcReduceRate(this.reduceRateChange),3!=this.templature&&this.measures.mRFtemplature.calcReduceRate(this.reduceRateTemplature),1!=this.space&&this.measures.mRFwall.calcReduceRate(this.reduceRateWall),1<this.count&&(0==this.subID?this.measures.mRFstop.calcReduceRate(1/this.count):this.measures.mRFstop.electricity=0)},D6.consLIsum=D6.object(D6.ConsBase),D6.consLIsum.init=function(){this.consName="consLIsum",this.consCode="LI",this.title="light",this.orgCopyNum=0,this.groupID="6",this.color="#ffff00",this.residueCalc="sumup",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="how to use the whole house lighting",this.lightTime=6,this.performanceLED=140,this.performanceHF=100,this.performanceFlueciend=70,this.preformanceBulb=15,this.wattLivingBulb=300,this.wattLivingFlue=70,this.wattLivingLED=40,this.outdoorWatt=150,this.outdoorTime=.5,this.sensorWatt=2,this.reduceRateBulb=1-this.preformanceBulb/this.performanceFlueciend,this.reduceRateCeiling=1-this.performanceFlueciend/this.performanceLED,this.reduceRateLED=1-this.preformanceBulb/this.performanceLED},D6.consLIsum.init(),D6.consLIsum.precalc=function(){this.clear(),this.person=this.input("i001",3),this.lightType=this.input("i501",2),this.otherRate=this.input("i502",3),this.houseSize=D6.consShow.TO.houseSize},D6.consLIsum.calc=function(){1==this.lightType?this.sumWatt=this.wattLivingBulb:3==this.lightType?this.sumWatt=this.wattLivingLED:this.sumWatt=this.wattLivingFlue,this.electricity=this.sumWatt*this.lightTime/1e3*30,this.electricity*=Math.max(this.houseSize-20,0)/20*.2+1,this.electricity*=Math.max(this.houseSize-20,0)/20*.5*(this.otherRate/10)+1},D6.consLIsum.calc2nd=function(){var e=this.electricity;for(var t in this.clear(),this.partCons)this.add(this.partCons[t]);e>this.electricity&&(this.electricity=e)},D6.consLIsum.calcMeasure=function(){},D6.consLI=D6.object(D6.consLIsum),D6.consLI.init=function(){this.consName="consLI",this.consCode="",this.title="light",this.orgCopyNum=1,this.addable="room for lighting",this.groupID="6",this.color="#ffff00",this.countCall="th room",this.sumConsName="consLIsum",this.sumCons2Name="",this.inputGuide="how to use each room lighting"},D6.consLI.init(),D6.consLI.precalc=function(){this.clear();this.rid=this.input("i511"+this.subID,0),this.mesTitlePrefix=this.rid?["","玄関","門灯","廊下","トイレ","脱衣所","風呂","居室"][this.rid]:this.mesTitlePrefix,this.type=this.input("i512"+this.subID,2),this.watt=this.input("i513"+this.subID,-1),this.num=this.input("i514"+this.subID,0),this.time=this.input("i515"+this.subID,this.lightTime)},D6.consLI.calc=function(){0<this.watt||(this.type<=2?this.watt=60:this.watt=100),this.electricity=this.watt*this.time*this.num/1e3*365/12},D6.consLI.calc2nd=function(){if(0==this.subID){this.electricity=this.sumCons.electricity;for(var e=D6.consListByName[this.consName],t=1;t<e.length;t++)this.electricity-=e[t].electricity;1==this.lightType?this.type=1:3==this.lightType?this.type=5:this.type=2,this.watt=this.sumWatt,this.num=1}},D6.consLI.calcMeasure=function(){var e=!1;(this.isSelected("mLILED")||this.isSelected("mLIceilingLED")||this.isSelected("mLIsensor"))&&(e=!0),5==this.type||6==this.type||this.watt<20||e||(1==this.type?this.measures.mLILED.calcReduceRate(this.reduceRateLED):2!=this.type&&3!=this.type||this.measures.mLILED.calcReduceRate((this.reduceRateLED-this.reduceRateBulb)/this.reduceRateLED)),3==this.type&&50<this.watt*this.num&&!e&&this.measures.mLIceilingLED.calcReduceRate(this.reduceRateCeiling),1<=this.rid&&this.rid<=3&&(this.measures.mLIsensor.electricity=365*(this.outdoorWatt*this.outdoorTime+24*this.sensorWatt)/1e3/12),2<=this.time&&this.measures.mLItime.calcReduceRate(1/(this.time-1))},D6.consTVsum=D6.object(D6.ConsBase),D6.consTVsum.init=function(){this.watt=100,this.reduceRateRadio=.5,this.reduceRateBright=.2,this.consName="consTVsum",this.consCode="TV",this.title="TV",this.orgCopyNum=0,this.groupID="7",this.color="#00ff00",this.sumConsName="consTotal",this.sumCons2Name="",this.residueCalc="sumup",this.inputGuide="how to use TV totally"},D6.consTVsum.init(),D6.consTVsum.calc=function(){this.useTime=this.input("i601",8.5),this.electricity=this.watt/1e3*this.useTime*30},D6.consTVsum.calc2nd=function(){var e=this.electricity;for(var t in this.clear(),this.partCons)this.add(this.partCons[t]);e>this.electricity&&(this.electricity=e)},D6.consTVsum.equip=function(e,t){return this.getEquipParameters(e,t,[20,30,40,50,60,120],{20:{1900:{pf1:100,pf2:150,pr1:5e5,pr2:4e5},1995:{pf1:50,pf2:100,pr1:5e4,pr2:4e4},2005:{pf1:40,pf2:80,pr1:4e4,pr2:3e4},2015:{pf1:30,pf2:50,pr1:3e4,pr2:25e3},2030:{pf1:20,pf2:30,pr1:3e4,pr2:25e3}},30:{1900:{pf1:150,pf2:300,pr1:5e5,pr2:4e5},1995:{pf1:80,pf2:150,pr1:8e4,pr2:6e4},2005:{pf1:50,pf2:100,pr1:5e4,pr2:4e4},2015:{pf1:40,pf2:60,pr1:4e4,pr2:35e3},2030:{pf1:30,pf2:40,pr1:4e4,pr2:35e3}},40:{1900:{pf1:400,pf2:500,pr1:5e5,pr2:4e5},1995:{pf1:300,pf2:500,pr1:2e5,pr2:15e4},2005:{pf1:100,pf2:200,pr1:12e4,pr2:1e5},2015:{pf1:60,pf2:120,pr1:1e5,pr2:8e4},2030:{pf1:40,pf2:80,pr1:8e4,pr2:7e4}},50:{1900:{pf1:500,pf2:700,pr1:5e5,pr2:4e5},1995:{pf1:500,pf2:700,pr1:4e5,pr2:3e5},2005:{pf1:200,pf2:400,pr1:2e5,pr2:18e4},2015:{pf1:100,pf2:200,pr1:14e4,pr2:12e4},2030:{pf1:80,pf2:160,pr1:1e5,pr2:9e4}},60:{1900:{pf1:500,pf2:700,pr1:5e5,pr2:4e5},1995:{pf1:500,pf2:700,pr1:5e5,pr2:4e5},2005:{pf1:250,pf2:500,pr1:4e5,pr2:3e5},2015:{pf1:120,pf2:200,pr1:18e4,pr2:16e4},2030:{pf1:100,pf2:180,pr1:16e4,pr2:15e4}},120:{1900:{pf1:500,pf2:700,pr1:5e5,pr2:4e5},1995:{pf1:500,pf2:700,pr1:5e5,pr2:4e5},2005:{pf1:350,pf2:500,pr1:4e5,pr2:3e5},2015:{pf1:200,pf2:400,pr1:18e4,pr2:16e4},2030:{pf1:180,pf2:250,pr1:16e4,pr2:15e4}}})},D6.consTVsum.calcMeasure=function(){this.measures.mTVradio.calcReduceRate(this.reduceRateRadio)},D6.consTV=D6.object(D6.consTVsum),D6.consTV.init=function(){this.consName="consTV",this.consCode="",this.title="TV",this.orgCopyNum=1,this.addable="TV",this.groupID="7",this.color="#00ff00",this.countCall="th",this.sumConsName="consTVsum",this.sumCons2Name="",this.inputGuide="How to use each TV"},D6.consTV.init(),D6.consTV.precalc=function(){this.clear(),this.size=this.input("i631"+this.subID,32),this.year=this.input("i632"+this.subID,6),1==this.subID?this.useTime=this.input("i633"+this.subID,8.5):this.useTime=this.input("i633"+this.subID,0);var e=new Date;this.nowEquip=this.equip(e.getFullYear()-this.year,this.size),this.newEquip=this.equip(e.getFullYear(),this.size),this.nowWatt=this.nowEquip.pf2,this.newWatt=this.newEquip.pf1},D6.consTV.calc=function(){this.reduceRateReplace=1-this.newWatt/this.nowWatt,this.electricity=this.useTime*this.nowWatt/1e3*30},D6.consTV.calc2nd=function(){if(0==this.subID){this.electricity=this.sumCons.electricity;for(var e=D6.consListByName[this.consName],t=1;t<e.length;t++)this.electricity-=e[t].electricity}},D6.consTV.calcMeasure=function(){0==this.subID&&0<D6.consListByName[this.consName][1].electricity||(2<this.useTime&&this.measures.mTVtime.calcReduceRate(1/(this.useTime-1)),this.measures.mTVbright.calcReduceRate(this.reduceRateBright),this.measures.mTVreplace.calcReduceRate(this.reduceRateReplace))},D6.consDRsum=D6.object(D6.ConsBase),D6.consDRsum.init=function(){this.whWash=100,this.whDry=1e3,this.reduceRateHeatPump=.65,this.res2Freq=[0,1,.5,.2,.07,0],this.consName="consDRsum",this.consCode="DR",this.title="laundry washing",this.orgCopyNum=0,this.groupID="5",this.color="#00ffff",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="How to use the cleaner, washing machine and clothes dryer"},D6.consDRsum.init(),D6.consDRsum.precalc=function(e){this.clear(),this.dryUse=this.input("i401",0),this.person=D6.consShow.TO.person},D6.consDRsum.calc=function(e){this.rateDry=this.whDry*this.res2Freq[this.dryUse]/(this.whWash+this.whDry*this.res2Freq[this.dryUse]),this.electricity=(this.whWash+this.whDry*this.res2Freq[this.dryUse])/1e3*this.person/3*30},D6.consDRsum.calcMeasure=function(){this.measures.mDRheatPump.calcReduceRate(this.rateDry*this.reduceRateHeatPump),this.measures.mDRsolar.calcReduceRate(this.rateDry)},D6.consCRsum=D6.object(D6.ConsBase),D6.consCRsum.init=function(){this.performanceNow=10,this.performanceNew=25,this.performanceElec=8,this.publicRate=.6,this.walkRate=.2,this.reduceRateEcoDrive=.15,this.reduceRatePublic=.7,this.consName="consCRsum",this.consCode="CR",this.title="vehicle",this.orgCopyNum=0,this.groupID="8",this.color="#ee82ee",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.inputGuide="How to use cars, automobile"},D6.consCRsum.init(),D6.consCRsum.precalc=function(){this.clear(),this.priceCar=D6.consShow.TO.priceCar,this.carNum=this.input("i901",-1),0==this.carNum&&D6.consShow.TO.noPriceData.car?(this.car=0,D6.consShow.TO.priceCar=0):this.car=this.priceCar/D6.Unit.price.car},D6.consCRsum.calc=function(){},D6.consCRsum.calcMeasure=function(){this.measures.mCRecoDrive.calcReduceRate(this.reduceRateEcoDrive)},D6.consCR=D6.object(D6.consCRsum),D6.consCR.init=function(){this.consName="consCR",this.consCode="",this.title="vehicle",this.orgCopyNum=1,this.groupID="8",this.color="#ee82ee",this.countCall="th car",this.addable="vehicle",this.sumConsName="",this.sumCons2Name="consCRsum",this.inputGuide="the performance and use of each car"},D6.consCR.init(),D6.consCR.precalc=function(){this.clear(),this.carType=this.input("i911"+this.subID,1),this.performance=this.input("i912"+this.subID,12),this.user=this.input("i913"+this.subID,this.subID+this.countCall),this.ecoTier=this.input("i914"+this.subID,3)},D6.consCR.calc=function(){},D6.consCR.calc2nd=function(){var e=0,t=D6.consListByName.consCR.length,s=D6.consListByName.consCRtrip.length;for(i=1;i<s;i++)e+=D6.consListByName.consCRtrip[i].car;0==e?0==this.subID?this.car=this.sumCons2.car:(this.car*=Math.pow(.5,this.subID),this.subID==t-1&&(this.car*=2)):this.car*=this.sumCons2.car/e},D6.consCR.calcMeasure=function(){this.isSelected("mCRreplaceElec")||this.measures.mCRreplace.calcReduceRate((this.performanceNew-this.performanceNow)/this.performanceNew),this.isSelected("mCRreplace")||(this.measures.mCRreplaceElec.clear(),this.measures.mCRreplaceElec.electricity=this.performanceNow*this.car/this.performanceElec)},D6.consCRtrip=D6.object(D6.consCRsum),D6.consCRtrip.init=function(){this.consName="consCRtrip",this.consCode="",this.title="movement",this.orgCopyNum=1,this.groupID="8",this.color="#ee82ee",this.countCall="th places",this.addable="destination",this.sumConsName="consCRsum",this.sumCons2Name="",this.inputGuide="how to use cars by destinations"},D6.consCRtrip.init(),D6.consCRtrip.precalc=function(){this.clear(),this.mesTitlePrefix=this.input("i921"+this.subID,this.mesTitlePrefix),this.frequency=this.input("i922"+this.subID,250),this.km=this.input("i923"+this.subID,0),this.carID=this.input("i924"+this.subID,1),this.consCar=D6.consListByName.consCR[this.carID]},D6.consCRtrip.calc=function(){this.performance=this.consCar.performance,this.car=2*this.km*this.frequency/12/this.performance,this.consCar.car+=this.car},D6.consCRtrip.calc2nd=function(){if(0==this.subID){this.car=this.sumCons.car;for(var e=D6.consListByName[this.consName],t=1;t<e.length;t++)this.car-=e[t].car}},D6.consCRtrip.calcMeasure=function(){this.km<3&&this.measures.mCRwalk.calcReduceRate(this.walkRate),this.measures.mCR20percent.calcReduceRate(.2),this.measures.mCRtrain.calcReduceRate(this.reduceRatePublic*this.publicRate)},D6.consCKsum=D6.object(D6.ConsBase),D6.consCKsum.init=function(){this.consName="consCKsum",this.consCode="CK",this.title="Cooking",this.orgCopyNum=0,this.groupID="4",this.color="#ffe4b5",this.countCall="",this.sumConsName="consTotal",this.sumCons2Name="",this.residueCalc="no",this.inputGuide="How to use cooking equipments"},D6.consCKsum.init(),D6.consCKsum.calc=function(){this.clear()},D6.consCKsum.calcMeasure=function(){},D6.consCKpot=D6.object(D6.ConsBase),D6.consCKpot.init=function(){this.wattOrdinal=30,this.consName="consCKpot",this.consCode="CK",this.title="heat holding pot",this.orgCopyNum=0,this.groupID="4",this.color="#ffe4b5",this.countCall="",this.sumConsName="consCKsum",this.sumCons2Name="",this.inputGuide="How to use heat holding pot"},D6.consCKpot.init(),D6.consCKpot.precalc=function(){this.clear(),this.time=this.input("i821",6),this.ecoType=this.input("i822",3)},D6.consCKpot.calc=function(){this.electricity=this.wattOrdinal*this.time*30/1e3*(1==this.ecoType?.5:1)},D6.consCKpot.calcMeasure=function(){},D6.consCKrice=D6.object(D6.ConsBase),D6.consCKrice.init=function(){this.wattOrdinal=30,this.consName="consCKrice",this.consCode="CK",this.title="rice cooker",this.orgCopyNum=0,this.groupID="4",this.color="#ffe4b5",this.countCall="",this.sumConsName="consCKsum",this.sumCons2Name="",this.inputGuide="how to use rice cooker"},D6.consCKrice.init(),D6.consCKrice.precalc=function(){this.clear(),this.person=this.input("i001",3),this.frequency=this.input("i802",5),this.time=this.input("i820",6)},D6.consCKrice.calc=function(){this.electricity=this.wattOrdinal*this.time*30/1e3},D6.consCKrice.calcMeasure=function(){},D6.consCKcook=D6.object(D6.ConsBase),D6.consCKcook.init=function(){this.consEnergyStat=84e4,this.efficentEL=2,this.consName="consCKcook",this.consCode="CK",this.title="Cooking",this.orgCopyNum=0,this.groupID="4",this.color="#ffe4b5",this.sumConsName="consCKsum",this.sumCons2Name="",this.inputGuide="How to use cooking to focus on the stove"},D6.consCKcook.init(),D6.consCKcook.precalc=function(){this.clear(),this.equipHW=this.input("i101",2),this.equipCK=this.input("i801",-1),this.person=this.input("i001",3)},D6.consCKcook.calc=function(){this.priceGas=D6.consShow.TO.priceGas,this.consEnergy=this.consEnergyStat*this.person/3,-1==this.equipCK&&(5==this.equipHW||6==this.equipHW||0==this.priceGas?this.equipCK=2:this.equipCK=1),2==this.equipCK?this.electricity=this.consEnergy/12/this.efficentEL/D6.Unit.calorie.electricity:this.gas=this.consEnergy/12/D6.Unit.calorie.gas},D6.consCKcook.calcMeasure=function(){};